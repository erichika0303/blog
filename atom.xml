<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan Microsoft Endpoint Manager Support Blog</title>
  
  <subtitle>日本マイクロソフト Microsoft Endpoint Manager サポート チームのブログです。</subtitle>
  <link href="https://jpmem.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://jpmem.github.io/blog/"/>
  <updated>2022-09-30T05:56:49.798Z</updated>
  <id>https://jpmem.github.io/blog/</id>
  
  <author>
    <name>Microsoft Endpoint Manager Support Japan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>知ってよかった！3 分でわかる！Microsoft Intuneチームが綴る、問題解決の時間短縮術</title>
    <link href="https://jpmem.github.io/blog/intune/20220913_00/"/>
    <id>https://jpmem.github.io/blog/intune/20220913_00/</id>
    <published>2022-09-29T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:49.798Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは! Microsoft Intune サポートチームのIshikawaです。<br>皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。</p><p>本投稿では弊社 Microsoft の Intune サポート チームへお問い合わせをご起票いただく際にお客様側で<strong>事前に採取可能な情報</strong>についてお纏めいたします。</p><p><strong>皆様の問題解決を、少しでもスムーズに支援することが可能になるためです。</strong></p><p>多くのお問い合わせにおいては、調査開始にあたり事象発生デバイスの情報が必要となります。</p><p>その場合、必要な情報の採取をお客様に依頼させていただきますが、依頼後に情報を採取いただき、私共にて受領するまでに平均 <strong>”1日~2日”</strong> を要しているのが実状です。</p><p>お問い合わせの起票前に情報を採取いただき、その情報とともにお問い合わせの起票をいただきますと、調査開始までの時間を現状より早められ、問題解決のためのご支援をよりスムーズに行える可能性がございます。</p><h1 id="どんな情報採取が効果的か"><a href="#どんな情報採取が効果的か" class="headerlink" title="どんな情報採取が効果的か"></a>どんな情報採取が効果的か</h1><p><strong>シナリオによって様々に異なります。</strong></p><p><strong>事前に「この情報だけ採取しておけばすべての調査が可能」という情報採取方法はございません。</strong><br>お問い合わせ内容、お客様の環境で起きている事象に応じて情報採取の内容や方法も変わってまいります。事象によっては、採取情報で判明した内容を元に、問題解決に向けて更なる情報採取をお願いさせていただくこともございます。</p><p>そのため必ず効果を得られるというものではありませんが、一方で、ある程度パターン化できるものがあり、その部分を事前に私共から皆様にお知らせすることで、よりスムーズな問題解決支援が可能となるのではないか、という思いから本投稿を記載しております。</p><h1 id="お客様に採取をお願いしたい情報"><a href="#お客様に採取をお願いしたい情報" class="headerlink" title="お客様に採取をお願いしたい情報"></a>お客様に採取をお願いしたい情報</h1><p>今回ご案内いたしますのは、Intune チームからお客様に依頼させていただくことがある情報採取の中で、最も基本的なものです。「最も基本的」とは、もし採取可能な状況であれば、お問い合わせ起票に先立ち、どのようなシナリオにおいても可能な限り準備いただきたい情報であることを意味します。</p><p>以下、後述 URL の Intune チームブログにて詳しい情報採取手順をご紹介しております。手順に沿って情報を採取いただき、お問い合わせの起票時にご提供いただけますと幸いです。</p><h2 id="どのような事象発生時にも採取をお願いしたい情報"><a href="#どのような事象発生時にも採取をお願いしたい情報" class="headerlink" title="どのような事象発生時にも採取をお願いしたい情報"></a>どのような事象発生時にも採取をお願いしたい情報</h2><ul><li>UPN</li><li>Intune デバイス ID</li><li>AAD デバイス ID</li><li>シリアル番号</li></ul><p>ご起票時に事前採取可能な基本情報の採取手順 &lt; <a href="https://jpmem.github.io/blog/intune/20220913_01/">https://jpmem.github.io/blog/intune/20220913_01/</a> &gt;</p><h2 id="モバイル端末を-Intune-に登録できない場合などに事前採取をお願いしたい情報"><a href="#モバイル端末を-Intune-に登録できない場合などに事前採取をお願いしたい情報" class="headerlink" title="モバイル端末を Intune に登録できない場合などに事前採取をお願いしたい情報"></a>モバイル端末を Intune に登録できない場合などに事前採取をお願いしたい情報</h2><ul><li>Intune ポータルサイトアプリのインシデント ID (iOS and Android)</li><li>MAM ログ</li></ul><p>ご起票時に事前採取可能なモバイルデバイス情報の採取手順 &lt; <a href="https://jpmem.github.io/blog/intune/20220913_02/">https://jpmem.github.io/blog/intune/20220913_02/</a> &gt;</p><h2 id="Autopilot-が失敗している場合に事前採取をお願いしたい情報"><a href="#Autopilot-が失敗している場合に事前採取をお願いしたい情報" class="headerlink" title="Autopilot が失敗している場合に事前採取をお願いしたい情報"></a>Autopilot が失敗している場合に事前採取をお願いしたい情報</h2><ul><li>Autopilot のログ</li></ul><p>ご起票時に事前採取可能な Autopilot ログの採取手順 &lt; <a href="https://jpmem.github.io/blog/intune/20220913_03/">https://jpmem.github.io/blog/intune/20220913_03/</a> &gt;</p><h3 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h3><p>日々弊社の Intune をご利用頂きありがとうございます。</p><p>本記事でのご案内事項は以上となります。少しでもお役に立つ情報であれば幸いです。<br>最後までお読みいただき、ありがとうございました !</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは! Microsoft Intune サポートチームのIshikawaです。&lt;br&gt;皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。&lt;/p&gt;
&lt;p&gt;本投稿では弊社 Microsoft の Intune サポート チームへお問い合わ</summary>
      
    
    
    
    
    <category term="Intune" scheme="https://jpmem.github.io/blog/tags/Intune/"/>
    
  </entry>
  
  <entry>
    <title>ご起票時に事前採取可能な基本情報の採取手順</title>
    <link href="https://jpmem.github.io/blog/intune/20220913_01/"/>
    <id>https://jpmem.github.io/blog/intune/20220913_01/</id>
    <published>2022-09-27T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:49.798Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは! Microsoft Intune サポートチームの Ishikawa です。<br>皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。</p><p>本投稿では弊社 Microsoft の Intune サポートチームへお問い合わせをご起票いただく際にお客様側で事前に採取可能な<strong>基本情報</strong>についてお纏めいたします。</p><p>下記内容及び、画面ショットは 2022/9/28 時点での仕様についての記載となっております。<br>弊社ではお客様のご意見を頂戴し、日々、品質向上に努めております。その為、製品アップデートが頻繁に行われており、お客様の手元環境とは表示等が異なる可能性がございますことを、予めご承知おきくださいますようお願い致します。</p><h1 id="基本情報"><a href="#基本情報" class="headerlink" title="基本情報"></a>基本情報</h1><p>今回ご案内をする情報採取手順は Intune チームからお客様にご案内をすることがある情報採取の中で最も基本的なものになります。<br><strong>この情報は、どのような事象発生時にも事前採取をお願いしたい内容になります。</strong></p><p><strong>ご案内する情報採取手順</strong></p><ul><li>UPN</li><li>Intune デバイス ID</li><li>AAD (Azure AD) デバイス ID</li><li>シリアル番号</li></ul><p>以下、情報採取手順をご説明いたします。</p><h2 id="1-事象発生デバイスの特定"><a href="#1-事象発生デバイスの特定" class="headerlink" title="1. 事象発生デバイスの特定"></a>1. 事象発生デバイスの特定</h2><p>弊社への問い合わせの際に、同一デバイス名で登録されている別デバイスの情報提供をいただくケースが少なくなく、その場合、いただいた情報からは調査が進められず、適切な調査対象デバイスにて改めて情報採取いただく必要がございます。これを避ける為、以下の手順でまずは事象発生デバイスの特定をお願いいたします。</p><p><strong>1. Microsoft Endpoint Manager admin center &lt; <a href="https://endpoint.microsoft.com/">https://endpoint.microsoft.com/</a> &gt; へログインする</strong></p><p><strong>2. 左側タブ内の [デバイス] &gt; [すべてのデバイス] の画面にて [デバイス名]、[OS]、[OSのバージョン]、[プライマリ ユーザーのUPN] を確認の上、事象発生デバイスの特定をする</strong></p><p><img src="/blog/intune/20220913_01/basic_01.png"></p><p>※ 同一デバイス名 (例 : iPhone) で複数デバイスが登録されている場合がございますので、事象発生デバイスのご確認をお願いします。</p><p>&lt;参考&gt;<br>UPN とはユーザーオブジェクトにユニークに付与されているメールアドレス形式の文字列です。<br>例) <a href="mailto:&#115;&#x61;&#109;&#x70;&#108;&#101;&#x40;&#105;&#110;&#x74;&#117;&#x6e;&#101;&#46;&#111;&#x6e;&#109;&#105;&#x63;&#x72;&#x6f;&#x73;&#x6f;&#102;&#x74;&#46;&#x63;&#111;&#x6d;">&#115;&#x61;&#109;&#x70;&#108;&#101;&#x40;&#105;&#110;&#x74;&#117;&#x6e;&#101;&#46;&#111;&#x6e;&#109;&#105;&#x63;&#x72;&#x6f;&#x73;&#x6f;&#102;&#x74;&#46;&#x63;&#111;&#x6d;</a></p><p>User Principal Nameとは &lt; <a href="https://docs.microsoft.com/ja-jp/azure/active-directory/hybrid/plan-connect-userprincipalname#what-is-userprincipalname">https://docs.microsoft.com/ja-jp/azure/active-directory/hybrid/plan-connect-userprincipalname#what-is-userprincipalname</a> &gt;</p><h2 id="2-事象発生デバイスの情報採取"><a href="#2-事象発生デバイスの情報採取" class="headerlink" title="2. 事象発生デバイスの情報採取"></a>2. 事象発生デバイスの情報採取</h2><!-- 前項の **1.事象発生デバイスの特定** をご確認いただきましたお客様につきましては、項目 3 以降の手順に従って事象発生デバイスの Intune デバイス ID、AAD (Azure AD) デバイス ID、シリアル番号をご確認いただけます。**1. Microsoft Endpoint Manager admin center < https://endpoint.microsoft.com/ > へログインする** --><p><strong>1. 特定した事象発生デバイスの [プライマリ ユーザーのUPN] を確認する</strong></p><p><img src="/blog/intune/20220913_01/basic_04.png"></p><p><strong>2. 事象発生デバイスのデバイス名を選択し、左側タブ内の [ハードウェア] を選択する</strong></p><p><img src="/blog/intune/20220913_01/basic_02.png"></p><p><strong>3. 表示される [Intune デバイス ID]、[Azure AD デバイス ID]、[シリアル番号] を確認する</strong></p><p><img src="/blog/intune/20220913_01/basic_03.png"></p><p><strong>4. 採取した UPN、Intune デバイス ID、Azure AD デバイス ID、シリアル番号を Microsoft 社への起票時に添付する</strong></p><p>※ 2022 年 9 月現在、Android 12 以降を実行している Android の個人所有の作業プロファイル デバイスのシリアル番号は表示されません。&lt; <a href="https://docs.microsoft.com/ja-jp/mem/intune/remote-actions/device-inventory#hardware-device-details">https://docs.microsoft.com/ja-jp/mem/intune/remote-actions/device-inventory#hardware-device-details</a> &gt;</p><h3 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h3><p>日々弊社の Intune をご利用頂きありがとうございます。<br>本記事、または Intune に関しましてご不明点等ございましたら、Service Request（お問い合わせ）にて Intune サポートチームの担当者にお気兼ねなくご相談ください。</p><p>本記事でのご案内事項は以上となります。少しでもお役に立つ情報であれば幸いです。<br>最後までお読みいただき、ありがとうございました !</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは! Microsoft Intune サポートチームの Ishikawa です。&lt;br&gt;皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。&lt;/p&gt;
&lt;p&gt;本投稿では弊社 Microsoft の Intune サポートチームへお問い合</summary>
      
    
    
    
    
    <category term="Intune" scheme="https://jpmem.github.io/blog/tags/Intune/"/>
    
  </entry>
  
  <entry>
    <title>ご起票時に事前採取可能なモバイルデバイス情報の採取手順</title>
    <link href="https://jpmem.github.io/blog/intune/20220913_02/"/>
    <id>https://jpmem.github.io/blog/intune/20220913_02/</id>
    <published>2022-09-27T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:49.802Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは! Microsoft Intune サポートチームの Ishikawa です。<br>皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。</p><p>本投稿では弊社 Microsoft の Intune サポートチームへお問い合わせをご起票いただく際にお客様側で事前に採取可能な<strong>モバイルデバイスの情報</strong>についてお纏めいたします。</p><p>下記内容及び、画面ショットは 2022/9/28 時点での仕様についての記載となっております。<br>弊社ではお客様のご意見を頂戴し、日々、品質向上に努めております。その為、製品アップデートが頻繁に行われており、お客様の手元環境とは表示等が異なる可能性がございますことを、予めご承知おきくださいますようお願い致します。</p><h1 id="モバイルデバイスの情報"><a href="#モバイルデバイスの情報" class="headerlink" title="モバイルデバイスの情報"></a>モバイルデバイスの情報</h1><p>今回ご案内をするのは Intune チームからお客様にご案内をすることがあるモバイルデバイスの情報採取手順になります。</p><p><strong>ご案内する情報採取手順</strong></p><ul><li>Intune ポータルサイトアプリのインシデント ID</li><li>MAM (Mobile Application Management) ログ</li></ul><p>iOS 端末、Android 端末のそれぞれついてご案内いたします。</p><h2 id="1-Intune-ポータルサイトアプリのインシデント-ID"><a href="#1-Intune-ポータルサイトアプリのインシデント-ID" class="headerlink" title="1. Intune ポータルサイトアプリのインシデント ID"></a>1. Intune ポータルサイトアプリのインシデント ID</h2><p>Intune ポータルサイトアプリのインシデント ID とは Intune ポータルサイトアプリに紐づけられた ID です。<br><strong>この情報は、モバイル端末を Intune に登録できない場合などに事前採取をお願いしたい内容になります。</strong></p><p>以下の手順で事象発生デバイスのインシデント ID を採取してご提供ください。iOS 端末と Android 端末では採取の手順が異なります。</p><h3 id="iOS-端末"><a href="#iOS-端末" class="headerlink" title="[iOS 端末]"></a>[iOS 端末]</h3><p><strong>1. iOS のポータルタイトアプリを起動する</strong></p><p><img src="/blog/intune/20220913_02/ios_01_f.PNG"></p><p><strong>2. 右下の[… その他] &gt; [<font color="DeepSkyBlue"> ヘルプ </font>] をタップする</strong></p><p><img src="/blog/intune/20220913_02/ios_02_f.PNG"></p><p><img src="/blog/intune/20220913_02/ios_03_f.PNG"></p><p><strong>3. [ヘルプの取得] 画面にて使用しているインシデント ID を確認する</strong></p><p><img src="/blog/intune/20220913_02/ios_04_f.PNG"></p><p><strong>4. 採取したインシデント ID を Microsoft 社への起票時に添付する</strong></p><h3 id="Android-端末"><a href="#Android-端末" class="headerlink" title="[Android 端末]"></a>[Android 端末]</h3><p><strong>1. Android のポータルサイトアプリを起動する</strong></p><p><img src="/blog/intune/20220913_02/and_00_f.png"></p><p><strong>2. 左上の [三] &gt; [ヘルプ] をタップする</strong></p><p><img src="/blog/intune/20220913_02/and_02_f.png"></p><p><img src="/blog/intune/20220913_02/and_03_f.png"></p><p><strong>3. [ログの送信] をタップする</strong></p><p><img src="/blog/intune/20220913_02/and_04_f.png"></p><p><strong>4. [ログのみ送信] をタップし、インシデント ID を確認する</strong></p><p><img src="/blog/intune/20220913_02/and_05_f.png"></p><p><img src="/blog/intune/20220913_02/and_01_f.png"></p><p>&lt;参考&gt;<br>Android アプリ ログを Microsoft に送信する &lt; <a href="https://docs.microsoft.com/ja-jp/mem/intune/user-help/send-logs-to-microsoft-android?source=recommendations#send-logs">https://docs.microsoft.com/ja-jp/mem/intune/user-help/send-logs-to-microsoft-android?source=recommendations#send-logs</a> &gt;</p><p><strong>5. 採取したインシデント ID を Microsoft 社への起票時に添付する</strong></p><h2 id="2-MAM-Mobile-Application-Management"><a href="#2-MAM-Mobile-Application-Management" class="headerlink" title="2. MAM (Mobile Application Management)"></a>2. MAM (Mobile Application Management)</h2><p>MAM (Mobile Application Management) ログとはモバイルアプリ管理に関する操作情報の記録です。<br><strong>この情報は、アプリ保護ポリシーが適用できない場合などに事前採取をお願いしたい内容になります。</strong></p><p><strong>Android 端末の場合、MAM ログと Intune ポータルサイトアプリのインシデント ID は同一となりますので、インシデント ID を弊社にご送信いただけますと、MAM ログも弊社にて確認が取れる状態となります。</strong></p><p>以下の手順で事象発生デバイスの MAM ログを採取してご提供ください。</p><h3 id="iOS端末"><a href="#iOS端末" class="headerlink" title="[iOS端末]"></a>[iOS端末]</h3><p><strong>1. iOS の Microsoft Edge アプリを起動する</strong></p><p><img src="/blog/intune/20220913_02/IMG_7358_f.PNG"></p><p><strong>2. [検索またはWebアドレスを入力] タブにて、”about:intunehelp” と入力する</strong></p><p><img src="/blog/intune/20220913_02/IMG_7360_f.PNG"></p><p><strong>3. [Intune 診断] 画面にて、[開始する] をクリックする</strong></p><p><img src="/blog/intune/20220913_02/IMG_7364_f.PNG"></p><p><strong>4. [Intune診断の収集] 画面にて、MAM ログ (参照 ID) を確認する</strong></p><p><img src="/blog/intune/20220913_02/IMG_7363_f.PNG"></p><p><strong>5. 採取した MAM ログを Microsoft 社への起票時に添付する</strong></p><p>※ Microsoft 製品以外のアプリの場合、アプリごとにログが出力される可能性がございますので、各ベンダー様に確認いただく場合がございます。</p><p>&lt;参考&gt;<br>iOS と Android に Edge を使用してマネージド アプリ ログにアクセスする &lt; <a href="https://docs.microsoft.com/ja-jp/mem/intune/apps/manage-microsoft-edge#use-edge-for-ios-and-android-to-access-managed-app-logs">https://docs.microsoft.com/ja-jp/mem/intune/apps/manage-microsoft-edge#use-edge-for-ios-and-android-to-access-managed-app-logs</a> &gt;</p><h3 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h3><p>日々弊社の Intune をご利用頂きありがとうございます。<br>本記事、または Intune に関しましてご不明点等ございましたら、Service Request（お問い合わせ）にて Intune サポートチームの担当者にお気兼ねなくご相談ください。</p><p>本記事でのご案内事項は以上となります。少しでもお役に立つ情報であれば幸いです。<br>最後までお読みいただき、ありがとうございました !</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは! Microsoft Intune サポートチームの Ishikawa です。&lt;br&gt;皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。&lt;/p&gt;
&lt;p&gt;本投稿では弊社 Microsoft の Intune サポートチームへお問い合</summary>
      
    
    
    
    
    <category term="Intune" scheme="https://jpmem.github.io/blog/tags/Intune/"/>
    
  </entry>
  
  <entry>
    <title>ご起票時に事前採取可能な Autopilot ログの採取手順</title>
    <link href="https://jpmem.github.io/blog/intune/20220913_03/"/>
    <id>https://jpmem.github.io/blog/intune/20220913_03/</id>
    <published>2022-09-27T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:49.850Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは! Microsoft Intune サポートチームの Ishikawa です。<br>皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。</p><p>本投稿では弊社 Microsoft の Intune サポート チームへお問い合わせをご起票いただく際にお客様側で事前に採取可能な <strong>Autopilot ログ</strong>についてお纏めいたします。</p><p>下記内容及び、画面ショットは 2022/9/28 時点での仕様についての記載となっております。<br>弊社ではお客様のご意見を頂戴し、日々、品質向上に努めております。その為、製品アップデートが頻繁に行われており、お客様の手元環境とは表示等が異なる可能性がございますことを、予めご承知おきくださいますようお願い致します。</p><h2 id="Autopilot-ログ"><a href="#Autopilot-ログ" class="headerlink" title="Autopilot ログ"></a>Autopilot ログ</h2><p>今回ご案内をするのは Intune チームからお客様にご案内をすることがある Autopilot ログの情報採取手順になります。<br><strong>このログ情報は、Autopilot が失敗している場合に事前採取をお願いしたい内容になります。</strong></p><p>以下の手順で事象発生デバイスの Autopilot ログを採取してご提供ください。</p><h3 id="Intune-へ登録できていない場合"><a href="#Intune-へ登録できていない場合" class="headerlink" title="[Intune へ登録できていない場合]"></a>[Intune へ登録できていない場合]</h3><p><strong>1. 該当デバイスにてエラーメッセージが表示されている画面上で Shift + F10 キーを押してコマンドプロンプトを開く</strong></p><p><img src="/blog/intune/20220913_03/autopilot_03.png"></p><p><strong>2. コマンドプロンプトから下記のコマンドを実行し、autopilot 関連の情報を採取する</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mdmdiagnosticstool.exe -area Autopilot;TPM -cab C:\Temp\autopilot.cab</span><br></pre></td></tr></table></figure><p>※ 手順 2 において、コマンドが失敗する場合は</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mdmdiagnosticstool.exe -area Autopilot -cab C:\Temp\autopilot.cab</span><br></pre></td></tr></table></figure><p>を実行ください。</p><p><strong>3. C:\Temp に格納されている autopilot.cab を Microsoft 社への起票時に添付する</strong></p><h3 id="Intune-へ登録できている場合"><a href="#Intune-へ登録できている場合" class="headerlink" title="[Intune へ登録できている場合]"></a>[Intune へ登録できている場合]</h3><p><strong>1. Microsoft Endpoint Manager admin center &lt; <a href="https://endpoint.microsoft.com/">https://endpoint.microsoft.com/</a> &gt; へログインし、[デバイス] &gt;  Windows] にて対象のデバイスを選択する</strong></p><p><strong>2. デバイスの [概要] ページ上部の [診断の収集] &gt; [はい] を選択すると、デバイスの [概要] ページに保留中の通知が表示される</strong></p><p><img src="/blog/intune/20220913_03/autopilot_01.png"></p><p>※ 上部に [診断の収集] が表示されていない場合は、[…] &gt; [診断の収集] のように選択ください。</p><p><strong>3. 左側の [モニター] 配下の [デバイス診断] を選択し、[ダウンロード] &gt; [はい] をクリックする</strong></p><p><img src="/blog/intune/20220913_03/autopilot_02.png"></p><p><strong>4. 採取した診断ログを Microsoft 社への起票時に添付する</strong></p><h3 id="最後に"><a href="#最後に" class="headerlink" title="最後に"></a>最後に</h3><p>日々弊社の Intune をご利用頂きありがとうございます。<br>本記事、または Intune に関しましてご不明点等ございましたら、Service Request（お問い合わせ）にて Intune サポートチームの担当者にお気兼ねなくご相談ください。</p><p>本記事でのご案内事項は以上となります。少しでもお役に立つ情報であれば幸いです。<br>最後までお読みいただき、ありがとうございました !</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは! Microsoft Intune サポートチームの Ishikawa です。&lt;br&gt;皆様、平素より弊社 Intune をご利用いただきまして誠にありがとうございます。&lt;/p&gt;
&lt;p&gt;本投稿では弊社 Microsoft の Intune サポート チームへお問い</summary>
      
    
    
    
    
    <category term="Intune" scheme="https://jpmem.github.io/blog/tags/Intune/"/>
    
  </entry>
  
  <entry>
    <title>プロビジョニングが開始されない場合に確認するポイント</title>
    <link href="https://jpmem.github.io/blog/w365/2022-09-06_01/"/>
    <id>https://jpmem.github.io/blog/w365/2022-09-06_01/</id>
    <published>2022-09-05T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.066Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Microsoft Endpoint Manager サポートです。<br>本日は、ユーザーに Windows 365 Enterprise のライセンスを付与したのに、プロビジョニングが開始されない場合にご確認いただきたい点についてご紹介させていただきます。  </p><h2 id="免責事項"><a href="#免責事項" class="headerlink" title="免責事項"></a>免責事項</h2><p>下記内容は 2022/9/6 時点での内容についての記載となっております。<br>今後内容が更新されることもございますので、その点ご承知置きくださいますようお願い致します。  </p><h3 id="1-必要なライセンスが付与されているか"><a href="#1-必要なライセンスが付与されているか" class="headerlink" title="1. 必要なライセンスが付与されているか"></a>1. 必要なライセンスが付与されているか</h3><p>Windows 365 Enterprise のライセンスの他に、Intune や Windows、Azure AD のライセンスが必要です。<br><a href="https://docs.microsoft.com/ja-jp/windows-365/enterprise/requirements#licensing-requirements">ライセンスの要件</a>  </p><p>該当のユーザーに、これらのライセンスが付与されているかご確認ください。  </p><h3 id="2-プロビジョニング-ポリシーが割り当てているグループに所属しているか"><a href="#2-プロビジョニング-ポリシーが割り当てているグループに所属しているか" class="headerlink" title="2. プロビジョニング ポリシーが割り当てているグループに所属しているか"></a>2. プロビジョニング ポリシーが割り当てているグループに所属しているか</h3><p>案外見落としがちです。<br>プロビジョニング ポリシーを作成するときに、ポリシーを割り当てるグループを指定しますが、該当のユーザーがそのグループに所属していない場合、プロビジョニングは開始されません。<br>必要なライセンスを付与しているにもかかわらず、以下のように “未プロビジョニング” と表示されている場合、上記に該当します。  </p><p><img src="/blog/w365/2022-09-06_01/2022-09-06-18-06-57.png">  </p><p>この場合は、該当のユーザーをプロビジョニング ポリシーで指定しているグループに所属させることでプロビジョニングが開始されますので、お試しください。  </p><p>以上、プロビジョニングが開始されない場合にご確認いただきたい点のご紹介でした。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Microsoft Endpoint Manager サポートです。&lt;br&gt;本日は、ユーザーに Windows 365 Enterprise のライセンスを付与したのに、プロビジョニングが開始されない場合にご確認いただきたい点についてご紹介させていただ</summary>
      
    
    
    
    
    <category term="Windows 365" scheme="https://jpmem.github.io/blog/tags/Windows-365/"/>
    
  </entry>
  
  <entry>
    <title>クラウド PC に接続できない場合の対処方法について</title>
    <link href="https://jpmem.github.io/blog/w365/2022-08-09_01/"/>
    <id>https://jpmem.github.io/blog/w365/2022-08-09_01/</id>
    <published>2022-08-08T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.066Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Microsoft Endpoint Manager サポート 山田 です。<br>本日は、ブラウザ経由やリモート デスクトップ アプリからクラウド PC に接続ができない場合の対処方法をいくつかご紹介させていただきます。</p><h2 id="免責事項"><a href="#免責事項" class="headerlink" title="免責事項"></a>免責事項</h2><p>下記内容は 2022/8/9 時点での内容についての記載となっております。<br>今後内容が更新されることもございますので、その点ご承知置きくださいますようお願い致します。  </p><h3 id="1-再起動を実施"><a href="#1-再起動を実施" class="headerlink" title="1. 再起動を実施"></a>1. 再起動を実施</h3><p>以下の画面からクラウド PC を再起動することにより、接続が行なえるようになる可能性がございますので、お試しください。  </p><p>■Microsoft Endpoint Manager から  </p><p><img src="/blog/w365/2022-08-09_01/2022-08-09-14-02-07.png">  </p><p>■Windows 365 ポータル画面から  </p><p><img src="/blog/w365/2022-08-09_01/2022-08-09-14-27-08.png">  </p><h3 id="2-再プロビジョニングを実施"><a href="#2-再プロビジョニングを実施" class="headerlink" title="2. 再プロビジョニングを実施"></a>2. 再プロビジョニングを実施</h3><p>再起動で改善がない場合、クラウド PC を再プロビジョニングすることにより、接続が行なえるようになる可能性がございますので、お試しください。  </p><p>■Microsoft Endpoint Manager から  </p><p><img src="/blog/w365/2022-08-09_01/2022-08-09-15-17-32.png">  </p><h3 id="3-多要素認証の設定について"><a href="#3-多要素認証の設定について" class="headerlink" title="3. 多要素認証の設定について"></a>3. 多要素認証の設定について</h3><p>Microsoft 管理センターで多要素認証が有効になっている場合、クラウド PC への接続に失敗するため、以下をご確認ください。  </p><ol><li>Microsoft 管理センターにサインインします。<br><a href="https://admin.microsoft.com/Adminportal/Home">https://admin.microsoft.com/Adminportal/Home</a>  </li><li>[設定] - [組織設定] を選択し、[多要素認証] - [多要素認証を構成する] を選択します。  </li><li>表示された画面で、該当のユーザーの MULTI-FACTOR AUTHENTICATION の状態を確認します。  </li><li>[有効] になっている場合は、[無効] に設定の上、クラウド PC に接続できるか確認します。<br><img src="/blog/w365/2022-08-09_01/2022-08-09-15-36-30.png">  </li></ol><p>上記 3 点を実施後もクラウド PC への接続ができない場合、調査が必要でございますので、弊社サポートへのお問い合わせをご検討いただけますと幸いです。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Microsoft Endpoint Manager サポート 山田 です。&lt;br&gt;本日は、ブラウザ経由やリモート デスクトップ アプリからクラウド PC に接続ができない場合の対処方法をいくつかご紹介させていただきます。&lt;/p&gt;
&lt;h2 id=&quot;免責</summary>
      
    
    
    
    
    <category term="Windows 365" scheme="https://jpmem.github.io/blog/tags/Windows-365/"/>
    
  </entry>
  
  <entry>
    <title>ハードウェア インベントリで HKLM 配下の特定のレジストリを収集する ～使い方シリーズ～</title>
    <link href="https://jpmem.github.io/blog/mecm/20220722_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220722_01/</id>
    <published>2022-07-21T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.042Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チームです。  </p><p>使い方シリーズ、今回はハードウェア インベントリで HKLM 配下の特定のレジストリを収集する方法についてご案内いたします。<br>特定のレジストリ値を収集して、管理コンソールやレポートで確認したいという場合に本手順をお役立ていただけますと幸いです。</p><h1 id="想定シナリオ"><a href="#想定シナリオ" class="headerlink" title="想定シナリオ"></a>想定シナリオ</h1><p>以下のレジストリ値を収集して、値が 2 のデバイスを抽出することを目的とします。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">キー：HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters</span><br><span class="line">値  ：DisableIPSourceRouting (REG_DWORD)</span><br></pre></td></tr></table></figure><p>他のレジストリ値についても、mof ファイルをレジストリ値に応じてカスタマイズすることで収集可能ですのでお試しください。</p><h1 id="手順"><a href="#手順" class="headerlink" title="手順"></a>手順</h1><p>以下の流れで手順を進めていきます。</p><ol><li>MOF ファイルを作成する</li><li>インベントリの収集対象に追加する</li></ol><h2 id="1-MOF-ファイルを作成する"><a href="#1-MOF-ファイルを作成する" class="headerlink" title="1. MOF ファイルを作成する"></a>1. MOF ファイルを作成する</h2><p>まずはテスト端末で手順をお試しください。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">キー：HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters</span><br><span class="line">値  ：DisableIPSourceRouting (REG_DWORD)</span><br></pre></td></tr></table></figure><ol><li>取得したいレジストリ値の MOF ファイルを作成します。<br>configuration.mof 追記用とインポート用の 2 つの MOF ファイルが必要となります。<br>例えば、今回収集対象とするレジストリ値の場合は以下の通りです。</li></ol><ul><li><p>configuration.mof</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#pragma namespace (&quot;\\\\.\\root\\cimv2&quot;)</span><br><span class="line">#pragma deleteclass(&quot;TcpipParametersInfo&quot;, NOFAIL)</span><br><span class="line">[DYNPROPS]</span><br><span class="line">Class TcpipParametersInfo</span><br><span class="line">&#123;</span><br><span class="line">[key] string KeyName;</span><br><span class="line">Uint32 DisableIPSourceRouting;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">[DYNPROPS]</span><br><span class="line">Instance of TcpipParametersInfo</span><br><span class="line">&#123;</span><br><span class="line">KeyName=&quot;Value&quot;;</span><br><span class="line">[PropertyContext(&quot;Local|HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters|DisableIPSourceRouting&quot;),Dynamic,Provider(&quot;RegPropProv&quot;)] DisableIPSourceRouting;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p>importclass.mof</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#pragma namespace (&quot;\\\\.\\root\\cimv2&quot;)</span><br><span class="line">#pragma deleteclass(&quot;TcpipParametersInfo&quot;, NOFAIL)</span><br><span class="line">[SMS_Report(TRUE),SMS_Group_Name(&quot;TcpipParametersInfo&quot;),SMS_Class_ID(&quot;TcpipParametersInfo&quot;)]</span><br><span class="line">Class TcpipParametersInfo: SMS_Class_Template</span><br><span class="line">&#123;</span><br><span class="line">[SMS_Report(TRUE),key] string KeyName;</span><br><span class="line">[SMS_Report(TRUE)] Uint32 DisableIPSourceRouting;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ul><p>上記 MOF ファイル内の「TcpipParametersInfo」の部分は任意の名前で構いません。<br><code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters</code> の部分は収集対象にしたいレジストリ キーになります。<br><code>DisableIPSourceRouting</code> の部分は収集対象にしたいレジストリ値になります。</p><p>準備ができた後、検証用のコンピューターでコマンド プロンプトから MOF ファイルのあるパスに移動し、以下のコマンドを実行します。</p><p><code>mofcomp -check xxxx.mof</code>　<br>（xxxx にはmof につけたファイル名を入れてください）</p><p>構文チェックでエラーが出力されないことを確認しましょう。</p><h2 id="2-インベントリの収集対象に追加する"><a href="#2-インベントリの収集対象に追加する" class="headerlink" title="2. インベントリの収集対象に追加する"></a>2. インベントリの収集対象に追加する</h2><ol><li>最上位の Configuration Manager サイト サーバー (中央管理サイト、及びスタンドアロン プライマリ サイト) にて、以下のファイルをバックアップしておきます。</li></ol><p><code>\Program Files\Microsoft Configuration Manager\inboxes\clifiles.src\hinv\configuration.mof</code><br>※ \Program Files\Microsoft Configuration Manager は Configuration Manager サイトのインストール先に応じて変更されます。</p><ol start="2"><li><p>configuration.mof をメモ帳で開き、手順 1. で作成した configuration.mof 追記用 MOF ファイルの内容を一番下に追記して保存します。具体的には、ファイル末尾の “Added extensions start/ end” の 2 行の間に挿入します。</p></li><li><p>上記作業により、SMS_EXECUTIVE サービスがまもなくファイルの変更を検知し、追加内容をクライアントへのポリシーに変換します。</p></li><li><p>最上位のサイト サーバーにて、Configuration Manager コンソールを起動し、[管理] - [クライアント設定] を開きます。</p></li><li><p>右上ペインに表示された [既定のクライアント設定] を右クリックして、プロパティを開きます。</p></li><li><p>[既定の設定] 画面のハードウェア インベントリを開き、[クラスの設定] をクリックします。</p></li><li><p>[インポート] ボタンをクリックして、手順 1. で作成したインポート用 MOF ファイルをインポートします。</p></li><li><p>追加されたクラスのチェック ボックスをオンにして、[OK] をクリックします。</p></li><li><p>動作確認のため、サイト管理下にある Configuration Manager クライアントが動作しているテスト マシンにおいて、コントロールパネルから Configuration Manager を開いて、以下のサイクルを順番に実行します。</p></li></ol><ul><li>[コンピューターポリシーの取得および評価サイクル]  </li><li>[ハードウェア インベントリ サイクル]</li></ul><p>反映されたポリシーを受信するまでに時間がかかる場合がありますので、テストの際は上記サイクルを何度か実行ください。</p><p>拡張したハードウェアインベントリが正常に収集されると、Configuration Manager コンソールから対象マシンを右クリックして、リソース エクスプローラを起動することで、収集したレジストリ情報をご確認いただけます。</p><p>また、収集したレジストリ情報は、サイト データベースに存在するv_GS_&lt;クラス名&gt;0 ビューより参照することができます。<br>(上記例ではクラス名が TcpipParametersInfo でしたので、ビュー名は v_GS_TcpipParametersInfo0 となります。)</p><h1 id="収集したレジストリ値が、サーバー側に反映されるタイミングについて"><a href="#収集したレジストリ値が、サーバー側に反映されるタイミングについて" class="headerlink" title="収集したレジストリ値が、サーバー側に反映されるタイミングについて"></a>収集したレジストリ値が、サーバー側に反映されるタイミングについて</h1><p>MOF ファイルで定義したレジストリ値は、ハードウェア インベントリ データの 1 つとして収集されます。<br>データがサイト サーバーに送信され、正常に処理が完了した時点で、データベースに格納されます。<br>また、クライアントは、サイト サーバーで設定されたスケジュールに従って、それぞれインベントリを収集します。  </p><p>インベントリの実行間隔は、既定では 7 日毎に実行されるように設定されておりますので、クライアントに設定されたレジストリ値が、把握できるようになるまで、時間差が生じる可能性がございます。<br>実行間隔はクライアント設定で変更可能ですが、頻繁にインベントリ収集が行われるように設定した場合、ネットワーク トラフィックの増加、及びデータを処理するサイト サーバーの CPU 負荷の上昇といった現象が発生する場合もございます。<br>そのため、実行間隔の設定値については、クライアント台数やサイト サーバーの処理能力、ネットワーク環境を踏まえた上で、ご検討ください。</p><h1 id="結果を確認する方法"><a href="#結果を確認する方法" class="headerlink" title="結果を確認する方法"></a>結果を確認する方法</h1><p>収集されたレジストリ値については、以下の 2 つの方法で確認できます。</p><ol><li>データベースに SQL を発行して確認する</li><li>コレクションを作成して確認する</li></ol><h2 id="1-データベースに-SQL-を発行して確認する"><a href="#1-データベースに-SQL-を発行して確認する" class="headerlink" title="1. データベースに SQL を発行して確認する"></a>1. データベースに SQL を発行して確認する</h2><p>収集したレジストリは、サイト データベースに格納されます。<br>今回収集したレジストリ値は、v_GS_TcpipParametersInfo0 より参照できますので、以下の SQL で出力された結果より、DisableIPSourceRouting が 2 のデバイスが確認できます。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> b.Name0,a.DisableIPSourceRouting0 <span class="keyword">from</span> v_GS_TcpipParametersInfo0 a <span class="keyword">join</span> v_R_System b <span class="keyword">on</span> a.ResourceID<span class="operator">=</span>b.ResourceID</span><br><span class="line"><span class="keyword">where</span> a.DisableIPSourceRouting0<span class="operator">=</span><span class="number">2</span>  </span><br></pre></td></tr></table></figure><p>SQL の実行方法については、以下の記事をご参照ください。</p><p>Title: SQL Query 結果の出力方法について<br>URL: <a href="https://jpmem.github.io/memlog/configmgr/sql/sqlquery.html">https://jpmem.github.io/memlog/configmgr/sql/sqlquery.html</a>  </p><h2 id="2-コレクションを作成して確認する"><a href="#2-コレクションを作成して確認する" class="headerlink" title="2. コレクションを作成して確認する"></a>2. コレクションを作成して確認する</h2><p>収集したレジストリ値をもとに、DisableIPSourceRouting が 2 のデバイスのみが所属するコレクションを作成します。</p><ol><li><p>Configuration Manager コンソールを起動し、[資産とコンプライアンス] - [デバイス コレクション] を開きます。</p></li><li><p>[デバイス コレクション] を右クリックし、[デバイス コレクションの作成] を選択します。</p></li><li><p>[デバイス コレクションの作成] ウィザードが起動します。</p></li><li><p>[全般] にて、次の設定を行います。  </p></li></ol><ul><li>[名前] フィールドに任意のコレクション名を記入します。</li><li>[限定コレクション] の [参照] ボタンをクリックし、対象のコレクション（例：”すべてのシステム”）を選択します。</li></ul><ol start="5"><li>[メンバーシップの規則] にて以下の設定を行います。</li></ol><ul><li>[規則の追加] - [クエリ規則] を選択します。</li><li>[クエリ規則のプロパティ] の設定で、以下の設定を行います。<ul><li>[名前] フィールドに適宜名前を入力します。</li><li>[クエリ ステートメントの編集] をクリックします。</li></ul></li><li>クエリ ステートメントのプロパティが開きます。<ul><li>[条件] タブを選択し、黄色いボタンをクリックします。</li><li>[条件プロパティ] が開きますので、以下のように条件指定して [OK] をクリックします。クエリ ステートメントのプロパティに戻り [OK] をクリックしてクエリのプロパティ画面をすべて閉じます。</li></ul></li></ul><p>&lt;DisableIPSourceRouting が 2 のデバイス 抽出用の条件&gt;  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">条件の種類：    単純な値</span><br><span class="line">属性クラス：    TcpipParametersInfo</span><br><span class="line">属性    ：      DisableIPSourceRouting</span><br><span class="line">演算子  ：      が次の値に等しい</span><br><span class="line">値      ：      2</span><br></pre></td></tr></table></figure><ol start="6"><li><p>[次へ] をクリックして、ウィザードを進め、デバイス コレクションの作成ウィザードを終了します。</p></li><li><p>[デバイス コレクション] 画面にて作成したコレクションを右クリックして [メンバーシップの更新] を実行します。</p></li><li><p>作成したコレクションを右クリックして [メンバーの表示] を実行します。</p></li></ol><p>コレクション作成後、DisableIPSourceRouting のインベントリを送信した端末の中で、その値が 2 のデバイスが作成したコレクションに表示されていきますので、経過をご確認ください。<br>最終的に、意図する端末がコレクション上に表示されているかどうかをご確認ください。</p><p>※ コレクション作成の注意点<br>本手順にて利用しているクエリは、ハードウェア インベントリによって収集するように構成したレジストリ値を参照しています。</p><p>期待通りのクエリ結果とならない場合は、リソース エクスプローラを利用してハードウェア インベントリの収集状況およびレジストリの値をご確認ください。</p><p>Title: Configuration Manager でリソース エクスプローラーを使用してハードウェア インベントリを表示する方法<br>URL: <a href="https://docs.microsoft.com/ja-jp/mem/configmgr/core/clients/manage/inventory/use-resource-explorer-to-view-hardware-inventory">https://docs.microsoft.com/ja-jp/mem/configmgr/core/clients/manage/inventory/use-resource-explorer-to-view-hardware-inventory</a></p><p>[ハードウェア] - [ワークステーションのステータス] で、最後にクライアントのハードウェア インベントリがレポートされた時間を確認します。<br>次に [ハードウェア] - [TcpipParametersInfo] で “DisableIPSourceRouting” の値を確認します。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チームです。  &lt;/p&gt;
&lt;p&gt;使い方シリーズ、今回はハードウェア インベントリで HKLM 配下の特定のレジストリを収集する方法についてご案内いたします。&lt;br&gt;特定のレジストリ値を収集して、管理</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
    <category term="使い方" scheme="https://jpmem.github.io/blog/tags/%E4%BD%BF%E3%81%84%E6%96%B9/"/>
    
  </entry>
  
  <entry>
    <title>MECM 管理コンソールでレポートが実行できない事象について</title>
    <link href="https://jpmem.github.io/blog/mecm/20220721_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220721_01/</id>
    <published>2022-07-20T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.042Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チームです。  </p><p>今回は MECM 管理コンソールでレポートが実行できない事象についてご案内いたします。 </p><h1 id="事象"><a href="#事象" class="headerlink" title="事象"></a>事象</h1><p>MECM コンソールをインストールしたマシンにおいて、Microsoft ReportViewer 2010 SP1 Redistributable をアンインストールした場合、MECM 管理コンソールより、レポートを実行しても実行できない事象が発生します。<br>この事象が発生した場合、以下のログが記録されます。</p><p><code>&lt;MECM コンソール インストール フォルダー&gt;\AdminConsole\AdminUILog\SmsAdminUI.log</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">System.IO.FileNotFoundException</span><br><span class="line">Could not load file or assembly &#x27;Microsoft.ReportViewer.WinForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&#x27; or one of its dependencies. The system cannot find the file specified.</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.ReportViewerWindowsForms..ctor()</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.LaunchReportFormViewControl.InitializeComponent()</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.LaunchReportFormViewControl..ctor()</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.LaunchReportDialog.InitializeReportControl()</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.LaunchReportDialog..ctor(Tag tag)</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.Actions.ShowReport(IReport report, IReportServer reportServer, IResultObject resultObject)</span><br><span class="line">   at Microsoft.ConfigurationManagement.AdminConsole.SrsReporting.Actions.LaunchReport(Object formView, ScopeNode scopeNode, ActionDescription actionDescription, IResultObject resultObject, PropertyDataUpdated propertyDataUpdated, Status status)</span><br></pre></td></tr></table></figure><h1 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h1><p>MECM 管理コンソールのレポート ビューアーではレポートを表示する際に、内部的に ReportViewer ランタイムを使用しています。<br>そのため、Microsoft ReportViewer 2010 SP1 Redistributable をアンインストールすると、MECM 管理コンソールのレポート ビューアーを使用して、レポートを表示できなくなります。</p><h1 id="回避策"><a href="#回避策" class="headerlink" title="回避策"></a>回避策</h1><p>MECM のレポート機能は、MECM 管理コンソールのレポート ビューアーで表示する方法と、ブラウザから表示可能な Web ベースのレポートを表示する方法が公式にサポートされております。</p><p>Title: Configuration Manager でのレポートの概要 - SQL Server Reporting Services<br>URL: <a href="https://docs.microsoft.com/ja-jp/mem/configmgr/core/servers/manage/introduction-to-reporting#sql-server-reporting-services">https://docs.microsoft.com/ja-jp/mem/configmgr/core/servers/manage/introduction-to-reporting#sql-server-reporting-services</a>  </p><blockquote><p>Configuration Manager レポート ビューアーを使用するか、レポートへの Web ベースの接続であるレポート マネージャーを使用してレポートを表示します。</p></blockquote><p>ReportViewer をアンインストールしたマシンであっても、管理コンソールより対象レポートを選択し [ブラウザーで実行] をクリックすることで、ブラウザよりレポートを実行できます。<br>Microsoft ReportViewer 2010 SP1 Redistributable をアンインストールしており、コンソールからレポートが実行できない場合は、[ブラウザーで実行] をクリックする方法をご利用くださいますようお願いいたします。</p><p><img src="/blog/mecm/20220721_01/1.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チームです。  &lt;/p&gt;
&lt;p&gt;今回は MECM 管理コンソールでレポートが実行できない事象についてご案内いたします。 &lt;/p&gt;
&lt;h1 id=&quot;事象&quot;&gt;&lt;a href=&quot;#事象&quot; class=&quot;h</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
  </entry>
  
  <entry>
    <title>Configuration Manager から更新プログラムを配信する際の再起動通知の動作について (2022 新版)</title>
    <link href="https://jpmem.github.io/blog/mecm/20220714_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220714_01/</id>
    <published>2022-07-13T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.038Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チーム青木です。<br>本記事では、Configuration Manager から更新プログラム配信時の再起動動作についてご紹介いたします。また、本記事は以下の記事の新版となります。  </p><p>Title : Configuration Manager から更新プログラムを配信する際の再起動動作について<br>URL : <a href="https://jpmem.github.io/blog/mecm/20180719_01/">https://jpmem.github.io/blog/mecm/20180719_01/</a>  </p><p>Configuration Manager から更新プログラムを展開する際に、Configuration Manager で再起動を抑制させる/再起動させる設定のお役立て情報おまとめいたしました。また、新版では再起動通知の動作についてもご紹介しております。   </p><h2 id="再起動を抑制する場合"><a href="#再起動を抑制する場合" class="headerlink" title="再起動を抑制する場合"></a>再起動を抑制する場合</h2><p>展開設定時に [デバイスの再起動] - [サーバー(サーバーOSの場合) or ワークステーション(クライアントOSの場合)]　にチェックを入れることで、再起動の抑制をすることが可能です。</p><p><img src="/blog/mecm/20220714_01/1.png" alt="image.png"></p><p>上記設定値を入れることで以下のポップアップとなります。</p><p><img src="/blog/mecm/20220714_01/2.png" alt="image.png"></p><h2 id="再起動をさせる場合"><a href="#再起動をさせる場合" class="headerlink" title="再起動をさせる場合"></a>再起動をさせる場合</h2><p>展開設定時に [デバイスの再起動] - [サーバー(サーバーOSの場合) or ワークステーション(クライアントOSの場合)]　のチェックを無効にすることで、強制的に再起動させることが可能です。  </p><p><img src="/blog/mecm/20220714_01/3.png" alt="image.png"></p><h2 id="再起動通知を制御するクライアント設定について"><a href="#再起動通知を制御するクライアント設定について" class="headerlink" title="再起動通知を制御するクライアント設定について"></a>再起動通知を制御するクライアント設定について</h2><p>Configuration Manager コンソールから、クライアント設定を設定することで再起動時の通知の動作を制御出来ます。<br>以下に具体的な設定とその動作をご紹介いたします。再起動が必要な旨をユーザーに通知させたい管理者の方々のご参考になりましたら幸いです。  </p><h3 id="lt-再起動通知の動作-gt"><a href="#lt-再起動通知の動作-gt" class="headerlink" title="&lt;再起動通知の動作&gt;"></a>&lt;再起動通知の動作&gt;</h3><p>Configuration Manager コンソールにて、クライアント設定の “コンピューターの再起動” タブで下記項目を “はい” に設定いただきますと、再起動を促すダイアログ通知をクライアントに表示させることができます。<br>下記項目を “いいえ” に設定するとトースト通知をクライアントに表示させることができます。これらの 2 種類の通知を、お好みによってお使い分けていただければと思います。</p><ul><li>該当のクライアント設定 (既定値は “いいえ” の為、”はい” に設定する必要が有ります。)  <pre><code>展開で再起動が必要な場合、トースト通知ではなくダイアログ ウインドウをユーザーに表示する  </code></pre></li></ul><p>▼ クライアント設定 サンプル画像 (既定値)<br><img src="/blog/mecm/20220714_01/4.png" alt="image.png">  </p><p>▼ ダイアログ通知 サンプル画像<br><img src="/blog/mecm/20220714_01/5.png" alt="image.png">  </p><p>なお、ダイアログ通知のタイミングにつきましては、下記 2 つのタイミングで行われます。  </p><ol><li>クライアントに再起動が必要な更新プログラムがインストールされた直後のタイミング  </li><li>クライアント設定の “期限後にユーザーへの再起動リマインダー通知の頻度を指定する” で設定した、リマインダー通知のタイミング<br>(リマインダー通知のタイミングとは、ダイアログ通知で “再通知” をクリックした後、次のダイアログ通知が表示される際のタイミング)  </li></ol><p>通知機能の詳細につきましては、以下の公開情報に記載されております為、こちらもご参考になりましたら幸いでございます。  </p><p>Title : Configuration Managerのデバイス再起動通知<br>URL : <a href="https://docs.microsoft.com/ja-jp/mem/configmgr/core/clients/deploy/device-restart-notifications">https://docs.microsoft.com/ja-jp/mem/configmgr/core/clients/deploy/device-restart-notifications</a></p><h2 id="実際の再起動通知の動作画面をご紹介します"><a href="#実際の再起動通知の動作画面をご紹介します" class="headerlink" title="実際の再起動通知の動作画面をご紹介します"></a>実際の再起動通知の動作画面をご紹介します</h2><p>下記の内容のクライアント設定を適用し、ダイアログ通知が行われるタイミングを検証いたしました為以下に併せてご案内いたします。ぜひ貴社ご運用のご参考になりましたら幸いでございます。  </p><p>▼ 検証の為に設定したクライアント設定<br><img src="/blog/mecm/20220714_01/6.png" alt="image.png">  </p><p>&lt;検証&gt;</p><ol><li><p>クライアントにて MECM から展開した更新プログラムのダウンロードが完了すると、以下の 2 つのトースト通知が行われた。<br><img src="/blog/mecm/20220714_01/7.png" alt="image.png">  </p></li><li><p>更新プログラムのインストール後に再起動を要する場合、直ぐに以下のダイアログ通知が行われた。<br>ダイアログ通知に表示されている “コンピューターが自動的に再起動するまでの残り時間” は、クライアント設定の “期限後からデバイスが再起動されるまでの経過時間を指定します” で設定した 10 分が反映している。<br><img src="/blog/mecm/20220714_01/8.png" alt="image.png">  </p></li><li><p>「2.」のダイアログ通知で “再通知” をクリックした場合、ダイアログ通知が一旦消え、2 分後に再度ダイアログ通知が行われた。<br>クライアント設定の “期限後にユーザーへの再起動リマインダー通知の頻度を指定する” で設定した 2 分が反映している。<br><img src="/blog/mecm/20220714_01/9.png" alt="image.png">  </p></li><li><p>リマインダー通知が行われたタイミングで、再起動までの時間が、クライアント設定の “デバイスが再起動されるまでの最終カウントダウン通知をユーザーに表示する時間を指定します” で設定した 5 分以内になった為、”再通知” がグレーアウトして押せなくなった。また、×をクリックしてもダイアログ通知が消えなくなった。<br><img src="/blog/mecm/20220714_01/10.png" alt="image.png"> </p></li></ol><p>上記のように、リマインダー通知のタイミングを制御する事で、どのくらいの頻度でユーザーへ通知を出すのか等の運用を決めることが出来る為、本記事をご参考にしていただきつつ会社の運用に併せて設定値を決めていただければと思います。  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チーム青木です。&lt;br&gt;本記事では、Configuration Manager から更新プログラム配信時の再起動動作についてご紹介いたします。また、本記事は以下の記事の新版となります。  &lt;/p&gt;
</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Endpoint Configuration Manager におけるピアキャッシュ機能について - その 2 (動作編)</title>
    <link href="https://jpmem.github.io/blog/mecm/20220713_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220713_01/</id>
    <published>2022-07-12T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.038Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チーム青木です。  </p><p>MECM からのコンテンツの配布の際に、ネットワークの負荷を軽減できるピアキャッシュ機能は実際にどのような動作となっているのか、ログの抜粋と共にご紹介させていただきます。<br>本ブログは以下ブログのシリーズ第 2 弾です。ピアキャッシュの概要については以下ブログをご参考にしてくださいませ。  </p><p>Title : System Center Configuration Manager における BranchCache、ピアキャッシュ機能について - その 1 (概要編)<br>URL : <a href="https://jpmem.github.io/blog/mecm/20180911_01/">https://jpmem.github.io/blog/mecm/20180911_01/</a>  </p><h2 id="ピアキャッシュを有効にして、コンテンツを展開した場合のログの解説"><a href="#ピアキャッシュを有効にして、コンテンツを展開した場合のログの解説" class="headerlink" title="ピアキャッシュを有効にして、コンテンツを展開した場合のログの解説"></a>ピアキャッシュを有効にして、コンテンツを展開した場合のログの解説</h2><p>ピアキャッシュが有効の場合のログを抜粋し、実際にどのような動作が行われるのかを解説します。  </p><p>ピアキャッシュを有効にしている場合に、ピアキャッシュ クライアントがコンテンツを取得する際の動作は C\Windows\CCM\Logs\ContentTransferManager.log に記述されます。  </p><hr><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:32:57.986    ContentTransferManager    8316 (0x207c)    CTM_StartJob - Starting CTM job &#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;  </span><br><span class="line">04-12-2022 20:32:57.986    ContentTransferManager    8316 (0x207c)    Created CTM job &#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125; for user S-1-5-18  </span><br><span class="line">04-12-2022 20:32:58.001    ContentTransferManager    1936 (0x790)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_WAITING_CONTENTLOCATIONS  </span><br><span class="line">04-12-2022 20:32:58.001    ContentTransferManager    1936 (0x790)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): Queued location request LSRequest(&#x27;&#123;028DE696-C020-4CF7-8B55-F478FC3EF3BE&#125;&#x27;).  </span><br></pre></td></tr></table></figure><p>コンテンツの展開を受け取ったクライアントは、クライアントがコンテンツを取得する先のピアキャッシュ ソース 及び 配布ポイントをリストアップするためのリクエストを管理ポイントへ行います。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:32:58.220    ContentTransferManager    2532 (0x9e4)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::_PersistLocations - Persisted locations  </span><br><span class="line">(SUBNETPEER) https://&lt;ピアキャッシュ ソース 1 台目のFQDN&gt;:8003/SCCM_BranchCache$/5d595a40-5699-4775-99a7-5f28b083750a  </span><br><span class="line">(SUBNETPEER) https://&lt;ピアキャッシュ ソース 2 台目のFQDN&gt;:8003/SCCM_BranchCache$/5d595a40-5699-4775-99a7-5f28b083750a  </span><br><span class="line">(SUBNET) http://&lt;配布ポイント&gt;/SMS_DP_SMSPKG$/5d595a40-5699-4775-99a7-5f28b083750a  </span><br><span class="line">(SUBNET) https://&lt;配布ポイント&gt;/CCMTOKENAUTH_SMS_DP_SMSPKG$/5d595a40-5699-4775-99a7-5f28b083750a  </span><br></pre></td></tr></table></figure><p>ピアキャッシュ ソース 及び 配布ポイントが一覧でリストアップされます。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:32:58.439    ContentTransferManager    2532 (0x9e4)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::_DownloadContent - Created corresponding DTSJob(&#123;00CDF3E3-5C6A-4AFF-8F0E-8622CD538C8A&#125;)  </span><br><span class="line">04-12-2022 20:32:58.439    ContentTransferManager    2532 (0x9e4)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::_DownloadContent - DTSJob(&#123;00CDF3E3-5C6A-4AFF-8F0E-8622CD538C8A&#125;) started to download from &#x27;https://FAB-W10Client2.fabrikam.com:8003/SCCM_BranchCache$/5d595a40-5699-4775-99a7-5f28b083750a&#x27; for full content download.  </span><br></pre></td></tr></table></figure><p>リスト内の一番上のピアキャッシュ ソースからコンテンツのダウンロードを開始します。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:32:58.455    ContentTransferManager    4188 (0x105c)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_DOWNLOADING_MANIFEST  </span><br><span class="line">04-12-2022 20:32:58.502    ContentTransferManager    2532 (0x9e4)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_PROCESSING_MANIFEST  </span><br><span class="line">04-12-2022 20:32:58.517    ContentTransferManager    4384 (0x1120)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_PREPARING_DOWNLOAD  </span><br><span class="line">04-12-2022 20:32:58.534    ContentTransferManager    4384 (0x1120)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_DOWNLOADING_DATA  </span><br></pre></td></tr></table></figure><p>ダウンロードが進行中である事が記述されます。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:35:06.731    ContentTransferManager    3384 (0xd38)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): _ModifyDTSDownloadLocation - switched to location &#x27;https://&lt;ピアキャッシュ ソース 2 台目のFQDN&gt;:8003/SCCM_BranchCache$/5d595a40-5699-4775-99a7-5f28b083750a&#x27;  </span><br></pre></td></tr></table></figure><p>ネットワーク イシュー等が原因でリスト内の一番上のピアキャッシュ ソースからダウンロードが出来なかった為、リスト内の上から 2 番目のピアキャッシュ ソースからのダウンロードにスイッチ (変更) しました。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:35:06.731    ContentTransferManager    8592 (0x2190)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_DOWNLOADING_MANIFEST  </span><br></pre></td></tr></table></figure><p>ダウンロードが進行中である事が記述されます。 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:35:27.828    ContentTransferManager    5524 (0x1594)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): _ModifyDTSDownloadLocation - switched to location &#x27;http://&lt;配布ポイント&gt;/SMS_DP_SMSPKG$/5d595a40-5699-4775-99a7-5f28b083750a&#x27;  </span><br></pre></td></tr></table></figure><p>こちらもネットワーク イシュー等が原因でダウンロードが出来ず、リスト内の上から 3 番目の配布ポイントからのダウンロードにスイッチ (変更) しました。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:35:27.828    ContentTransferManager    5900 (0x170c)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_DOWNLOADING_MANIFEST  </span><br></pre></td></tr></table></figure><p>ダウンロードが進行中である事が記述されます。 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">04-12-2022 20:35:28.054    ContentTransferManager    5900 (0x170c)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_PROCESSING_MANIFEST  </span><br><span class="line">04-12-2022 20:35:28.069    ContentTransferManager    3384 (0xd38)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_PREPARING_DOWNLOAD  </span><br><span class="line">04-12-2022 20:35:28.085    ContentTransferManager    3384 (0xd38)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessProgress - entered phase CCM_DOWNLOADSTATUS_DOWNLOADING_DATA  </span><br><span class="line">04-12-2022 20:35:32.879    ContentTransferManager    3384 (0xd38)    CTMJob(&#123;C3D5CF8B-458E-425A-AEB2-365F6B78250C&#125;): CCTMJob::ProcessDownloadSuccess - successfully processed download completion.  </span><br></pre></td></tr></table></figure><p>最終的に配布ポイントからコンテンツのダウンロードが完了しました。  </p><hr><p>上記のようにピアキャッシュの動作は ContentTransferManager.log に記述される為、もし「ピアキャッシュを有効にしたが、きちんと動作しているか心配」というご状況でございましたら、上記のログの流れがご参考になりましたら幸いです。  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チーム青木です。  &lt;/p&gt;
&lt;p&gt;MECM からのコンテンツの配布の際に、ネットワークの負荷を軽減できるピアキャッシュ機能は実際にどのような動作となっているのか、ログの抜粋と共にご紹介させていただ</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
  </entry>
  
  <entry>
    <title>WSUS の仕組み レポート編</title>
    <link href="https://jpmem.github.io/blog/wsus/2022-07-07_01/"/>
    <id>https://jpmem.github.io/blog/wsus/2022-07-07_01/</id>
    <published>2022-07-06T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.134Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。WSUS サポート チームです。</p><p>今回は、WSUSのレポートの仕組みについて、ご紹介していきたいと思います。<br>WSUS ではクライアントから状態レポートが報告され、それをもとにクライアントの更新プログラムの適用状況などを把握することができますが、<br>その仕組みの理解やレポートが報告されていないときなどのトラブルシューティングの際に、お役立ていただける情報となっていますので是非ご一読ください！  </p><h1 id="WSUS-の仕組み"><a href="#WSUS-の仕組み" class="headerlink" title="WSUS の仕組み"></a>WSUS の仕組み</h1><p>WSUS にクライアントからレポートが送られるときの流れは以下の通りです。    </p><ol><li>クライアントが次の処理を実施（更新プログラムの検出、ダウンロード、インストール）  </li><li>その結果をもとに状態レポートが WSUS へ送信される  </li><li>WSUSが状態レポートを受け取る  </li></ol><p>解説  </p><ol><li>クライアントが次の処理を実施（更新プログラムの検出、ダウンロード、インストール）<br>各処理の流れは以下の通りです。</li></ol><p>ⅰ. 更新プログラムの検出処理開始<br>ⅱ. 更新プログラムの検出処理完了 ＞ 2 を実施<br>ⅲ．ダウンロード処理開始<br>ⅳ．ダウンロード処理完了 ＞ 2 を実施<br>ⅴ．インストール処理開始<br>ⅵ．インストール処理完了 ＞ 2 を実施  </p><ol start="2"><li><p>1.の結果をもとに状態レポートがクライアントからWSUSへ送信<br>以下のフォルダにイベントを含むファイルが生成されます。<br>作成されたファイルは、IISの ReportingWebService を介してWSUSデータベースへ送信されます。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%windir%\SoftwareDistribution\EventCache.v2</span><br></pre></td></tr></table></figure></li><li><p>WSUS が状態レポートを受け取る<br>送信されたイベントファイルが WSUS データベースへ格納され、状態レポートとして WSUS で表示されます。  </p></li></ol><p>状態レポートの見方については以下の記事をご参照ください。<br><a href="https://jpmem.github.io/blog/wsus/2017-09-04_02/">WSUS のレポートに表示される「状態」の項目の説明</a></p><h1 id="トラブルシュート方法"><a href="#トラブルシュート方法" class="headerlink" title="トラブルシュート方法"></a>トラブルシュート方法</h1><p>状態レポートが WSUS にあがらないときに、まずご実施いただきたいトラブルシュート方法についてご紹介します。<br>以下の手順に沿って、検出処理実行からイベントファイル作成及び送信の動作をご確認ください。</p><p>1-1.[設定]&gt;[WindowsUpdate]&gt;[更新プログラムのチェック]を実行し検出を完了させます。<br>1-2.下記フォルダにイベントファイルが作成されたことを確認します。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%windir%\SoftwareDistribution\EventCache.v2</span><br></pre></td></tr></table></figure><p>1-3.以下のコマンドを実行します。  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wuauclt /reportnow</span><br></pre></td></tr></table></figure><p>1-4. 1-2 で作成されたファイルがフォルダから消えていることを確認します。  </p><h3 id="1-1-から-1-4-まで全てが確認できた場合"><a href="#1-1-から-1-4-まで全てが確認できた場合" class="headerlink" title="1-1 から 1-4 まで全てが確認できた場合"></a>1-1 から 1-4 まで全てが確認できた場合</h3><p>ここまでの処理が実行されているにもかかわらず、WSUS 側で状態レポートが更新されないなどの事象が発生している場合には、<br>WSUS データベースへの書き込み処理の失敗なども疑われます為 の WSUS 及びクライアントのファイル送信時のログなども併せて確認する必要があります。  </p><h3 id="1-4-にてイベントファイルが送信されず滞留してしまう場合"><a href="#1-4-にてイベントファイルが送信されず滞留してしまう場合" class="headerlink" title="1-4 にてイベントファイルが送信されず滞留してしまう場合"></a>1-4 にてイベントファイルが送信されず滞留してしまう場合</h3><p>Windows Update のクライアント情報のキャッシュをクリアすることで解消されることがありますので、以下の記事に記載の手順をご実施ください。<br><a href="https://social.msdn.microsoft.com/Forums/ja-JP/8cec0049-4b41-4976-a440-d4012c8510ca/windows-update?forum=jpsccmwsus">Windows Update クライアントの情報をクリアにする手順</a>  </p><h3 id="補足：状態レポート報告完了の確認方法"><a href="#補足：状態レポート報告完了の確認方法" class="headerlink" title="補足：状態レポート報告完了の確認方法"></a>補足：状態レポート報告完了の確認方法</h3><p>WSUS コンソールより対象端末の最後の状態レポートの日時列の情報を参照してください。<br>WSUS コンソールを開き、 [コンピュータ] &gt; 確認対象のコンピュータを選択<br><img src="/blog/wsus/2022-07-07_01/2022-07-07_01_1.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。WSUS サポート チームです。&lt;/p&gt;
&lt;p&gt;今回は、WSUSのレポートの仕組みについて、ご紹介していきたいと思います。&lt;br&gt;WSUS ではクライアントから状態レポートが報告され、それをもとにクライアントの更新プログラムの適用状況などを把握すること</summary>
      
    
    
    
    
    <category term="WSUS" scheme="https://jpmem.github.io/blog/tags/WSUS/"/>
    
  </entry>
  
  <entry>
    <title>MECM 自動展開規則 ~使い方シリーズ~</title>
    <link href="https://jpmem.github.io/blog/mecm/20220706_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220706_01/</id>
    <published>2022-07-05T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.030Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チームです。  </p><p>使い方シリーズ、今回は自動展開規則の設定方法をステップバイステップで解説致します。<br>設定方法がよくわからない方、今の設定を見直したい方はぜひ確認してみてください。  </p><h2 id="事前準備"><a href="#事前準備" class="headerlink" title="事前準備"></a>事前準備</h2><p>自動展開規則を作成する前に、必要となる準備を行います。  </p><p>1.自動展開規則を展開するデバイス コレクションを作成します。<br>2.自動展開規則で使用する展開パッケージを新規に作成する場合には、事前に共有フォルダーを作成しておく必要がございます。任意のパスにフォルダーを作成の上、共有設定を行ってください。</p><h2 id="自動展開規則の作成手順"><a href="#自動展開規則の作成手順" class="headerlink" title="自動展開規則の作成手順"></a>自動展開規則の作成手順</h2><p>1.MECM 管理コンソールを開き [ソフトウェア ライブラリ] &gt; [概要] &gt; [ソフトウェア更新プログラム] &gt; [自動展開規則] の順に開き、リボン上の [自動展開規則の作成] をクリックします。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_01.png" alt="image.png"></p><p>2.自動展開規則の作成ウィザードが開きますので、「全般」にて下記の設定を行います。  </p><ul><li><strong>名前</strong>　→　任意の名前を入力ください。  </li><li><strong>コレクション</strong>　→　自動展開規則を展開するデバイス コレクションを指定ください。  </li><li><strong>ソフトウェア更新プログラム グループ</strong>　→　<br>こちらについてはいずれを選んで頂いても問題ございませんが、[新しいソフトウェア更新プログラム グループを作成する] を選択した場合には、自動展開規則から更新プログラムが展開されるたびに新しいソフトウェア更新プログラム グループが追加作成されるため、グループが多数存在する状況となります。<br>そのため、特にこだわりがない場合には [既存のソフトウェア更新プログラム グループ] を選択くださいませ。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_02.png" alt="image.png"></p><p>3.「展開設定」にて、「展開の種類」を設定します。  </p><ul><li><strong>[必須] を指定した場合</strong><br>　→　ユーザー操作なしで自動的にインストールされます。  </li><li><strong>[利用可能] を指定した場合</strong><br>　→　ユーザーがクライアント端末側でソフトウェア センターを開き、[インストール] ボタンをクリックすることでインストールが開始されます。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_03.png" alt="image.png"></p><p>4.「ソフトウェア更新プログラム」にて、展開を行いたい更新プログラムのみが対象となるような「検索条件」を設定します。<br>この設定は非常に重要です。この検索条件が誤っていると意図していない更新プログラムが展開されてしまう可能性がございますので正しく設定しましょう。<br>検索条件でよく利用する代表的な項目に関しまして、<a href="###%E4%BB%A3%E8%A1%A8%E7%9A%84%E3%81%AA%E6%A4%9C%E7%B4%A2%E6%9D%A1%E4%BB%B6">代表的な検索条件</a> にて解説しておりますのでご確認くださいませ。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_09.png" alt="image.png"></p><p>5.「評価スケジュール」にて、任意の項目を選択の上、[次へ] をクリックします。  </p><ul><li><strong>[この規則を自動的に実行しない]</strong><br>　→　自動的に実行されないため手動での実行が必要となります。  </li><li><strong>[ソフトウェア更新ポイントが 1 つでも同期されたら、規則を実行する]</strong><br>　→　上部に表示されている [現在のソフトウェアの更新ポイントの同期スケジュール] のサイクルに沿って自動展開規則が実行されます。  </li><li><strong>[スケジュールに基づいて規則を実行する]</strong><br>　→　任意のスケジュールの設定が可能となります。  </li></ul><p>ソフトウェア更新ポイントの同期タイミングと自動展開規則の評価タイミングをずらしたいなど、特別なご事情が無い限りは [ソフトウェア更新ポイントが 1 つでも同期されたら、規則を実行する] を選択いただくことが一般的です。</p><p><img src="/blog/mecm/20220706_01/20220706_01_12.png" alt="image.png"></p><p>6.「展開スケジュール」にて、任意の項目を選択の上、[次へ] をクリックします。  </p><ul><li><strong>「基準」</strong><br>この展開のスケジュールを UTC、クライアントのローカル時刻のどちらを基準に評価するかを設定します。  </li></ul><p><strong>もしサーバーとタイムゾーンが異なるクライアントを管理する場合には「UTC」を選択頂く必要がございます。</strong><br>クライアントのタイムゾーンがすべて日本の場合には [クライアントのローカル時刻] を指定頂いても問題ございません。  </p><ul><li><strong>「ソフトウェアが使用可能な時間」および「インストールの期限」</strong><br>上記 2 つの設定によりクライアント側でインストールがスケジュールされる日時が決定します。<br>「ソフトウェアが使用可能な時間 ~ インストールの期限」の間でダウンロードがスケジュールされ、インストールの期限後にインストールが行われますので、すぐに適用させる場合にはいずれも [直ちに] を指定くださいませ。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_13.png" alt="image.png"></p><p>7.「ユーザー側の表示と操作」、「アラート」にて任意の設定を行い、[次へ] をクリックします。<br>8.「展開パッケージ」にて、既存の展開パッケージを使用する場合には [展開パッケージを選択する]、新しい展開パッケージを作成する場合には [新しい展開パッケージを使用する] を選択の上、「事前準備」で作成した共有フォルダーを [パッケージのソース] に指定し、[次へ] をクリックします。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_14.png" alt="image.png"></p><p>※ 下記手順 9 におきましては新たに展開パッケージを作成する際の解説となります。  </p><p>9.「配布ポイント」にてこの自動展開規則にて展開する更新プログラムのコンテンツを配置する配布ポイントを指定し、[次へ] をクリックします。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_15.png" alt="image.png"></p><p>10.「ダウンロード場所」にて [インターネットからソフトウェア更新プログラムをダウンロードする] を選択の上、[次へ] をクリックします。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_16.png" alt="image.png"></p><p>11.「言語の選択」にて言語を選択の上、[次へ] をクリックします。<br>12.「ダウンロードの設定」にて、任意の設定を行い、[次へ] をクリックします。  </p><ul><li><strong>[クライアントが近隣の境界グループまたは既定サイトの境界グループから配布ポイントを使用する時に適用する配置オプションを選択します。]</strong><br>近隣の境界グループ（フォールバック設定された境界グループ）または Default-Site-Boudary-Group （既定サイトの境界グループ）に紐づく配布ポイントを使用する場合の挙動を設定します。  </li></ul></br><ul><li><strong>[現在または近隣の境界グループのどの配布ポイントでもソフトウェア更新プログラムを利用できない場合、クライアントは、サイト既定の境界グループ内の配布ポイントからソフトウェアの更新をダウンロードして、インストールできます。]</strong><br>現在または近隣の境界グループの配布ポイントを参照できない場合に、 Default-Site-Boudary-Group （既定サイトの境界グループ）を参照させるかどうかの挙動を設定します。  </li></ul></br><ul><li><p><strong>[関連する任意の境界グループ内の配布ポイントでソフトウェア更新プログラムを利用できない場合は…]</strong><br>配布ポイントからのダウンロードができなかった場合に、インターネット上の Microsoft Update から更新プログラムをダウンロードさせたい場合には、チェックを入れてください。  </p></li><li><p><strong>[インストールの期限後、クライアントが従量制のインターネット接続を使用してコンテンツをダウンロードできるようにする]</strong><br>これはインストール期限を迎えた場合には、クライアントが従量制課金のネットワークを使用している場合でもコンテンツのダウンロードを許可するかの設定となります。  </p></li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_17.png" alt="image.png"></p><p>13.「概要」にて、これまでに設定した内容に誤りが無いか確認の上、[次へ] をクリックします。<br>14.「完了」にて、「正常に完了しました」と表示されることを確認し [閉じる] をクリックします。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_18.png" alt="image.png"></p><p>以上で自動展開規則の設定は完了となります。<br>設定後、下記の通り「最後のエラーの説明」=「成功」となることをご確認くださいませ。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_19.png" alt="image.png"></p><h3 id="代表的な検索条件"><a href="#代表的な検索条件" class="headerlink" title="代表的な検索条件"></a>代表的な検索条件</h3><p>設定方法は様々ありますので、代表的なもののみ解説させて頂きます。  </p><ul><li><strong>[置き換え済み]</strong><br>この設定は非常に重要です。この条件を設定することにより更新プログラムの置き換え状態を条件にすることができます。<br>累積的な更新プログラムは新しい更新プログラムがリリースされると古いものを置き換えます。<br>置き換えられた更新プログラムの内容は新しい更新プログラム内に内包されるため、古い更新プログラムを配信する必要がありません。<br>そのため [置き換え済み] = [いいえ] の更新プログラム（つまり置き換えられていない最新の更新プログラム）のみを展開対象とすることで無駄な更新プログラムの展開を行わずにすむ為、必須となる条件となります。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_07.png" alt="image.png"></p><ul><li><strong>[更新プログラムの分類] および [製品]</strong><br>各更新プログラムごとに、適用対象となる [更新プログラムの分類] および [製品] が決まっております。<br>そのため、この 2 つを条件に追加することで分類と製品によるフィルターをかけることが可能となります。</br>  </li></ul><p><strong>確認方法</strong><br>1.MECM 管理コンソール &gt; [ソフトウェア ライブラリ] &gt; [概要] &gt; [ソフトウェア更新プログラム] &gt; [すべてのソフトウェア更新プログラム] にて、項目名バーを右クリックし、[更新プログラムの分類] および [製品] にチェックを入れます。<br>2.配信対象の更新プログラムの [更新プログラムの分類] および [製品] をご確認ください。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_04.png" alt="image.png"></p><ul><li><strong>[リリース日または変更日]</strong><br>特定の期間内にリリースまたは変更された更新プログラムを配信対象とすることができます。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_05.png" alt="image.png"></p><ul><li><strong>[必須]</strong><br>ソフトウェア更新プログラムの必須カウントを条件にすることができます。<br>これを設定することにより、必須と判定された更新プログラムのみを配信対象とすることができます。<br>下記では「&gt;=1」と設定することにより、必須カウントが 1 以上の場合には対象とする条件となります。</br><br>なお、必須カウントはクライアント端末側で定期的に実行される「ソフトウェア更新プログラムのスキャン サイクル」により、端末それぞれで必要な更新プログラムを必須と判断しカウントされていきます。<br>そのため、新しく同期されたばかりのソフトウェア更新プログラムはすぐには必須判定されず、クライアント側のスキャン サイクル実行後にカウントされる流れとなります。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_06.png" alt="image.png"></p><ul><li><strong>[タイトル]</strong><br>指定した文字列に部分一致するタイトルの更新プログラムを配信対象とすることができます。<br>例えば下記の「Beta」を指定する場合には、「Microsoft Edge-ARM64 ベース エディションの Beta チャネル バージョン」という更新プログラムが該当します。<br>なお、タイトルにおきましては、文字列の検索となるため、入力ミスなどで意図していない条件となってしまう可能性があります。<br>そのためその他の条件だけでは希望する更新プログラムを絞りきれない時にご活用くださいませ。  </li></ul><p><img src="/blog/mecm/20220706_01/20220706_01_08.png" alt="image.png"></p><h3 id="検索条件が正しいかの確認方法"><a href="#検索条件が正しいかの確認方法" class="headerlink" title="検索条件が正しいかの確認方法"></a>検索条件が正しいかの確認方法</h3><p>検索条件を設定し終わりましたら、[プレビュー] を表示してみましょう。<br>すると設定した検索条件に合致する更新プログラムの一覧を確認することができます。<br>ここで意図していない更新プログラムが表示されている場合には条件が不足している、誤っていることが想定されるので、意図した更新プログラムのみが表示されるまで検索条件を見直しましょう。  </p><p><img src="/blog/mecm/20220706_01/20220706_01_10.png" alt="image.png"></p><p><img src="/blog/mecm/20220706_01/20220706_01_11.png" alt="image.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チームです。  &lt;/p&gt;
&lt;p&gt;使い方シリーズ、今回は自動展開規則の設定方法をステップバイステップで解説致します。&lt;br&gt;設定方法がよくわからない方、今の設定を見直したい方はぜひ確認してみてください</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
    <category term="使い方" scheme="https://jpmem.github.io/blog/tags/%E4%BD%BF%E3%81%84%E6%96%B9/"/>
    
  </entry>
  
  <entry>
    <title>通常の機能更新プログラムとイネーブルメント パッケージ、どちらを展開するべき？</title>
    <link href="https://jpmem.github.io/blog/mecm/20220702_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220702_01/</id>
    <published>2022-07-03T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.030Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート 山田です。  </p><p>今回は MECM や WSUS で、Windows 10 の OS を 21H1 や 21H2 などへアップグレードしたい場合、通常の機能更新プログラムとイネーブルメント パッケージのどちらを展開、承認するべきか解説させていただきます。  </p><h2 id="イネーブルメント-パッケージとは？"><a href="#イネーブルメント-パッケージとは？" class="headerlink" title="イネーブルメント パッケージとは？"></a>イネーブルメント パッケージとは？</h2><p>Windows 10 1903 と 1909、2004 ～ 21H2 は共通のコア オペレーティング システムを使用しています。<br>そのため、このイネーブルメント パッケージを展開するだけで、手軽に機能更新プログラムを適用できます。<br>通常の機能更新プログラムは数 GB ほどの大きい容量ですが、イネーブルメント パッケージは数十 KB ほどのため、ネットワークもひっ迫することなく機能更新が行えるため、とても便利です。  </p><h3 id="通常の機能更新プログラムとイネーブルメント-パッケージ、どちらを展開するべきか"><a href="#通常の機能更新プログラムとイネーブルメント-パッケージ、どちらを展開するべきか" class="headerlink" title="通常の機能更新プログラムとイネーブルメント パッケージ、どちらを展開するべきか"></a>通常の機能更新プログラムとイネーブルメント パッケージ、どちらを展開するべきか</h3><p>それではどちらを展開すべきか見ていきましょう。<br>具体的には、元の OS がどれを使用しているかに依存します。  </p><p>■ 例 21H2 にアップグレードしたい場合<br><strong>アップグレード元の OS が 1909 以前 (1909 を含む) → 通常の機能更新プログラム（例 Windows 10 (ビジネス エディション)、バージョン 21H2、ja-jp x64 の機能更新プログラム）を展開します。</strong>  </p><p><strong>アップグレード元の OS が 2004 以降 (2004 を含む) → イネーブルメント パッケージ（例 Windows 10 バージョン 21H2 x64ベースのシステムへの機能更新 2021-11 イネーブルメント パッケージ経由）を展開します。</strong>  </p><p>イネーブルメント パッケージを展開するためには前提条件が存在します。<br>前提条件を満たすことで MECM で “必須判定” されますので、あらかじめご確認ください。  </p><p>&lt;前提条件&gt;  </p><p>■20H2 へのアップグレードの場合 (KB4562830)  </p><p>・サービス スタック更新プログラム 2020 年 9 月 8 日 かそれ以降のサービス スタック更新プログラムを適用していること<br>・2020 年 10 月 13 日 KB4579311 (19041.572) かそれ以降のソフトウェア更新プログラムを適用していること  </p><p>参考情報 : <a href="https://support.microsoft.com/ja-jp/topic/feature-update-through-windows-10-version-20h2-enablement-package-02d91e04-931e-f00d-090c-015467c49f6c">Feature Update through Windows 10, version 20H2 Enablement Package</a>  </p><p>■21H1 へのアップグレードの場合</p><p>・サービス スタック更新プログラム 2020 年 9 月 8 日 かそれ以降のサービス スタック更新プログラムを適用していること<br>・2021 年 5 月 11 日 KB5003173 (19041.985) かそれ以降のソフトウェア更新プログラムを適用していること  </p><p>参考情報 : <a href="https://support.microsoft.com/ja-jp/topic/kb5000736-%E6%9C%89%E5%8A%B9%E5%8C%96%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%82%92%E4%BD%BF%E7%94%A8windows-10%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3-21h1-%E3%81%AB%E5%AF%BE%E3%81%99%E3%82%8B%E4%B8%BB%E3%81%AA%E6%9B%B4%E6%96%B0%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0-75a01e67-3b5f-4677-8efe-42852e41c7cf">KB5000736: 有効化パッケージを使用Windows 10バージョン 21H1 に対する主な更新プログラム</a>  </p><p>■21H2 へのアップグレードの場合</p><p>・サービス スタック更新プログラム 2020 年 9 月 8 日 かそれ以降のサービス スタック更新プログラムを適用していること<br>・2021 年 9 月 14 日 KB5005565 (19041.1237) かそれ以降のソフトウェア更新プログラムを適用していること  </p><p>参考情報 : <a href="https://support.microsoft.com/ja-jp/topic/kb5003791-%E6%9C%89%E5%8A%B9%E5%8C%96%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8windows-10%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3-21h2-%E3%82%92%E6%9B%B4%E6%96%B0-8bc077be-18d7-4aac-81ce-6f6dad2cd384">KB5003791: 有効化パッケージWindows 10バージョン 21H2 を更新 </a>  </p><h3 id="どちらが必須判定されているか確認する方法"><a href="#どちらが必須判定されているか確認する方法" class="headerlink" title="どちらが必須判定されているか確認する方法"></a>どちらが必須判定されているか確認する方法</h3><p>通常の機能更新プログラムとイネーブルメント パッケージのどちらが必須と判定しているか確認したい場合、MECM のレポート機能を使用すると一番わかりやすいです。  </p><p>■クライアント端末毎に確認するレポート<br>[監視] - [レポート] - [ソフトウェア更新プログラム - A コンプライアンス] - [コンプライアンス 5 - 特定のコンピューター]  </p><p>デバイス名：任意のクライアントを選択します。<br>更新クラス：Upgrades を選択します。  </p><p><img src="/blog/mecm/20220702_01/2022-07-04-10-05-50.png">  </p><p>上記はイネーブルメント パッケージが “必須判定” されている状態です。  </p><p>■更新プログラム毎に確認するレポート<br>[監視] - [レポート] - [ソフトウェア更新プログラム - A コンプライアンス] - [コンプライアンス 8 - 更新プログラムに対して特定のコンプライアンスの状態にあるコンピューター]  </p><p>更新：Windows 10 (ビジネス エディション)、バージョン 21H2、ja-jp x64 の機能更新プログラム など任意の更新プログラム<br>コレクション：対象のクライアントが所属するデバイス コレクション<br>状態名：2 - 更新を行う必要があります  </p><p><img src="/blog/mecm/20220702_01/2022-07-05-08-40-45.png"></p><p>上記は CL1 というデバイスが機能更新プログラムを必要と判定している状態です。  </p><h4 id="補足事項"><a href="#補足事項" class="headerlink" title="補足事項"></a>補足事項</h4><p>WSUS で承認する場合も上述の考え方は同じです。<br>WSUS もレポート機能がありますので、どちらが必要と判定しているか把握したい場合はレポートを参照してください。  </p><ul><li>レポートを出力する手順  </li></ul><ol><li>WSUS コンソールを開き、[WSUS サーバー名] - [コンピューター] - [すべてのコンピューター] と辿ります。  </li><li>該当のクライアント名を右クリックし、[状態レポート] を選択します。  </li><li>以下のように項目を選択し、[レポートの実行] を選択します。  </li></ol><p>次の分類に更新を含める：Upgrade<br>次の状態の更新プログラムを含める：必要  </p><p><img src="/blog/mecm/20220702_01/2022-07-04-19-04-38.png">  </p><p>[インストールされていません] という表記になっている場合は、該当の機能更新プログラムを必要と判定しています。  </p><p>参考情報<br><a href="https://jpmem.github.io/blog/wsus/2017-09-04_02/">WSUS のレポートに表示される「状態」の項目の説明</a>  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート 山田です。  &lt;/p&gt;
&lt;p&gt;今回は MECM や WSUS で、Windows 10 の OS を 21H1 や 21H2 などへアップグレードしたい場合、通常の機能更新プログラムとイネーブルメン</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
  </entry>
  
  <entry>
    <title>Azure Active Directory に存在する CPC-hth から始まるデバイス オブジェクトについて</title>
    <link href="https://jpmem.github.io/blog/w365/2022-06-16_01/"/>
    <id>https://jpmem.github.io/blog/w365/2022-06-16_01/</id>
    <published>2022-06-15T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.066Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Microsoft Endpoint Manager サポート 山田です。<br>本日は、Windows 365 Enterprise 環境を使用している際に見かける、Azure Active Directory 上の CPC-hth から始まるデバイス オブジェクトについてご紹介します。  </p><h2 id="免責事項"><a href="#免責事項" class="headerlink" title="免責事項"></a>免責事項</h2><p>下記内容は 2022/6/16 時点での内容についての記載となっております。<br>今後内容が更新されることもございますので、その点ご承知置きくださいますようお願い致します。  </p><h3 id="CPC-hth-とは"><a href="#CPC-hth-とは" class="headerlink" title="CPC-hth とは"></a>CPC-hth とは</h3><p>Windows 365 Enterprise で使用しているテナントの Azure Active Directory を開き、[すべてのデバイス] を見ると、以下のように CPC-hth から始まるデバイス オブジェクトが存在します。  </p><p><img src="/blog/w365/2022-06-16_01/2022-06-16-15-45-20.png">  </p><p>CPC-hth は Azure ネットワーク接続 (ANC) のチェックを行う際に、ドメイン参加を試みるために自動で生成されるデバイス オブジェクトです。<br>ANC は内部的に 6 時間に 1 回の頻度で行われ、CPC-hth から始まるデバイス オブジェクトを削除しても、チェックのタイミングで再生成されますが、ANC のチェック毎に CPC-hth のデバイス オブジェクトが増え続けることはございませんので、ご安心ください。  </p><p>■補足事項<br>オンプレミスの [Active Directory ユーザーとコンピューター] にも CPC-hth が存在することとなりますが、ANC のプロパティより以下の [組織単位] で指定した OU に CPC-hth のデバイス オブジェクトが生成されます。  </p><p><img src="/blog/w365/2022-06-16_01/2022-06-16-16-08-31.png">  </p><p>以上、CPC-hth から始まるデバイス オブジェクトについて、参考になれば幸いです。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Microsoft Endpoint Manager サポート 山田です。&lt;br&gt;本日は、Windows 365 Enterprise 環境を使用している際に見かける、Azure Active Directory 上の CPC-hth から始まるデバイ</summary>
      
    
    
    
    
    <category term="Windows 365" scheme="https://jpmem.github.io/blog/tags/Windows-365/"/>
    
  </entry>
  
  <entry>
    <title>パッケージ展開機能による MECM クライアント エージェントのバージョンアップ方法</title>
    <link href="https://jpmem.github.io/blog/mecm/20220610_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220610_01/</id>
    <published>2022-06-09T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.030Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チームです。  </p><p>Configuration Manager では、MECM クライアント エージェントのバージョン アップ方法が複数ございます。<br>自動クライアント アップグレードという機能が用意されておりますが、事前にテスト可能なコレクションは 1 つしか指定することはできず、その後にサイト全体へアップグレードを行うため、もう少し小刻みにバージョン アップをしたいというニーズがあることを、サポート インシデントを通してご要望頂くことがございます。<br>そこで今回は、パッケージ展開機能を利用する方法についてご紹介いたします。  </p><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><p><strong>A. パッケージとプログラムの作成</strong><br><strong>B. パッケージの展開</strong><br><strong>C. 展開結果の確認</strong><br><strong>D. 注意事項</strong>  </p><h2 id="A-パッケージとプログラムの作成"><a href="#A-パッケージとプログラムの作成" class="headerlink" title="A. パッケージとプログラムの作成"></a>A. パッケージとプログラムの作成</h2><ol><li><p>プライマリ サイト サーバー上で、事前に共有フォルダーを作成します。共有ファルダ―は新規で作成し、このパッケージ専用として扱います。<br>例：**”\\PriSite\MECMClient&quot;**  </p></li><li><p>プライマリ サイト サーバーの以下のフォルダーにアクセスします。<br>パス：**”&lt;サイトサーバーのインストール ドライブ&gt;:\Program Files\Microsoft Configuration Manager\Client”**</p></li><li><p>ccmsetup.exe ファイルのみを、共有フォルダーにコピーします。(手順 5. で使います)</p></li><li><p>MECM コンソールを起動し、[ソフトウェア ライブラリ] &gt; [アプリケーション管理] &gt; [パッケージ] を右クリックし、[パッケージの作成] をクリックします。</p></li><li><p>[パッケージとプログラムの作成ウィザード] の [パッケージ] より、任意の名前を入力し、[このパッケージにソース ファイルを含める] にチェックを入れ、[参照] をクリックします。</p></li><li><p>[ソース フォルダー] の設定より、さらに [参照] をクリックし、共有フォルダーのパスを入力し、[OK] をクリックします。</p></li><li><p>[パッケージ] より、共有フォルダーのパスが登録されていることを確認し、[次へ] をクリックします。</p></li><li><p>[プログラムの種類] より、[標準プログラム] が選択されている状態のまま、[次へ] をクリックします。</p></li><li><p>[標準プログラム] より、以下の項目を設定し、[参照] をクリックします。</p><ul><li>名前：任意の名前   </li><li>コマンド ライン：  </li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ccmsetup.exe /noservice /mp:&lt;管理ポイントの FQDN&gt; SMSMP=&lt;管理ポイントの FQDN&gt; SMSSITECODE=&lt;サイト コード&gt;</span><br><span class="line">例)：ccmsetup.exe /noservice /mp:PriSite.contoso.com SMSMP=PriSite.contoso.com SMSSITECODE=PS1</span><br></pre></td></tr></table></figure><ul><li>プログラムの実行条件：ユーザーのログオン状態に関係なし  </li><li>実行モード：管理者権限で実行する（自動で選択されます）  </li></ul></li><li><p>[要件] より、必要に応じて設定を行い、[次へ] をクリックします。</p></li><li><p>[概要] より、設定内容に誤りがないことを確認し、[次へ] をクリックします。</p></li><li><p>[完了] より、正常に完了したことを確認し、[閉じる] をクリックします。</p></li><li><p>[パッケージ] の [ナビゲーション ペイン] より、作成したパッケージが登録されていることを確認します。</p></li></ol><h2 id="B-パッケージの展開"><a href="#B-パッケージの展開" class="headerlink" title="B. パッケージの展開"></a>B. パッケージの展開</h2><ol><li><p>MECM コンソールより、[ソフトウェア ライブラリ] &gt; [アプリケーション管理] &gt; [パッケージ] を開きます。</p></li><li><p>先ほど作成したパッケージを右クリックし、[展開] をクリックし、[ソフトウェアの展開ウィザード] を開きます。</p></li><li><p>[全般] にて [コレクション] - [参照] をクリックし、展開先コレクションを指定し [OK] をクリックし、[次へ] をクリックします。</p></li><li><p>[コンテンツ] にて、[追加] をクリックし、配布ポイントを指定し、[次へ] をクリックします。</p></li><li><p>[展開設定] にて “目的” を [利用可能] とし、[次へ] をクリックします。<br>([必須] 場合にはサイレント実行されるため、テストする際には、[利用可能] とし、テストが成功することをご確認頂くことをお勧めいたします。)</p></li><li><p>[スケジュール] にて必要に応じたスケジュールを指定し、[次へ] をクリックします。</p></li><li><p>[ユーザー側の表示と操作] にて既定のまま [次へ] をクリックします。</p></li><li><p>[配布ポイント] にて、配布ポイントを指定して、[次へ] をクリックします。</p></li><li><p>[概要] にて [次へ] をクリックします。</p></li><li><p>ウィザードが完了したことを確認し、[閉じる] をクリックします。</p></li><li><p>展開後、[パッケージ] の [ナビゲーション ペイン] より、展開したパッケージのコンテンツ ステータスが緑色の円グラフになることを確認します。<br>※画面をリフレッシュして、円グラフの更新状況を確認ください。  </p></li></ol><h2 id="C-展開結果の確認"><a href="#C-展開結果の確認" class="headerlink" title="C. 展開結果の確認"></a>C. 展開結果の確認</h2><p>パッケージ展開機能により ccmsetup.exe の配布を行うと、MECM エージェントのサービスが再起動されるため、パッケージの展開ステータスで、「プログラムで問題が発生しました (予期しなかった再起動)」 と記録されることがございます。<br>これはステータスを送付するタイミングに依存して記録されるものであり、想定動作となりますのでご留意ください。  </p><p>そのため、バージョンアップが正しく行われたかどうかは、以下の確認方法を用います。<br>基本的には、MECM サーバー側でバージョンアップされていることが確認できましたら、クライアントから管理ポイントへバージョン情報が正しく渡っているため、これにより正しくクライアントが動作していることを判断します。  </p><h3 id="レポートによる確認"><a href="#レポートによる確認" class="headerlink" title="レポートによる確認"></a>レポートによる確認</h3><ol><li>MECM コンソールにて、[監視] &gt; [レポート] &gt; [レポート] &gt; [サイト - クライアント情報] を選択します。</li><li>[Configuration Manager クライアント バージョン別の数] を右クリックし、[実行] をクリックします。</li><li>レポートの結果が表示されますので、各バージョンをクリックすると、バージョン別のクライアント一覧がご確認頂けます。</li></ol><h3 id="デバイスの列名による確認"><a href="#デバイスの列名による確認" class="headerlink" title="デバイスの列名による確認"></a>デバイスの列名による確認</h3><ol><li><p>MECM コンソールにて、[資産とコンプライアンス] &gt; [デバイス] を選択します。</p></li><li><p>以下の列を追加し、各状態をチェックします。<br>・[アイコン]<br>・[名前]<br>・[クライアント]<br>・[クライアント アクティビティ]<br>・[クライアント バージョン]</p></li><li><p>目安としては、以下の点をチェックします。<br>・アイコン：<strong>緑色でチェックが付いているか</strong><br>・クライアント アクティビティ：<strong>アクティブになっているか</strong><br>・クライアント バージョン：<strong>想定バージョンになっているか</strong></p><p> <img src="/blog/mecm/20220610_01/20220609-01_01.png" alt="image.png">  </p></li><li><p>そのほか、実際にバージョンアップ後のクライアントに対して、<br>パッケージ展開や、ソフトウェア更新プログラムの展開を行い、目的の配信が正常に進みますか確認を行います。</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チームです。  &lt;/p&gt;
&lt;p&gt;Configuration Manager では、MECM クライアント エージェントのバージョン アップ方法が複数ございます。&lt;br&gt;自動クライアント アップグレー</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
  </entry>
  
  <entry>
    <title>MECM パッケージとアプリケーションどっちを使うべき？違いを解説！</title>
    <link href="https://jpmem.github.io/blog/mecm/20220608_02/"/>
    <id>https://jpmem.github.io/blog/mecm/20220608_02/</id>
    <published>2022-06-07T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.026Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チームです。  </p><p>今回は MECM のパッケージとアプリケーションの違いを解説させていただきます。これから展開を行いたいコンテンツがどちらを使えば要望にマッチするのか意識しながら確認してみてください。  </p><h2 id="実行タイミングの違い"><a href="#実行タイミングの違い" class="headerlink" title="実行タイミングの違い"></a>実行タイミングの違い</h2><p>パッケージとアプリケーションとで実行タイミングに大きな違いがありますのでそれぞれ解説させていただきます。  </p><p>※ なお、これから解説を行う実行タイミングは <strong>「必須」展開を前提</strong> としております。<br>「利用可能」展開の場合には、展開後のクライアント端末上のソフトウェア センターからのユーザー操作により実行されます。  </p><h3 id="パッケージの実行タイミング"><a href="#パッケージの実行タイミング" class="headerlink" title="パッケージの実行タイミング"></a>パッケージの実行タイミング</h3><p>パッケージでは明確に実行のタイミングを指定することができます。<br>「何時何分に実行したい」などの要件が明確な場合にはパッケージの使用を検討しましょう。  </p><p><img src="/blog/mecm/20220608_02/20220608_02_01.png" alt="image.png"></p><p>また、任意の間隔で繰り返し実行を設定することも可能です。<br>「繰り返しパターン」では月、週、時間単位で繰り返し実行をスケジュールすることができるので、「月末に実行させたい」や「毎週金曜日に実行させたい」、「6 時間おきに実行させたい」など様々なパターンを設定可能です。  </p><p><img src="/blog/mecm/20220608_02/20220608_02_02.png" alt="image.png"></p><h3 id="アプリケーションの実行タイミング"><a href="#アプリケーションの実行タイミング" class="headerlink" title="アプリケーションの実行タイミング"></a>アプリケーションの実行タイミング</h3><p>アプリケーションではパッケージのような特定のタイミングで実行、繰り返し実行を設定することはできません。  </p><p>アプリケーションではインストール可能となる日時と、インストールの期限を設定します。<br>クライアントがアプリケーションが展開されたことを検知すると設定されたインストール可能日時とインストール期限の間でランダムにインストール日時をスケジュールします。  </p><p>なお、展開後すぐに実行させたい場合には、[アプリケーションが使用可能になる日時を指定する] のチェックを外し、「インストール期限」= [使用可能な時間後直ちに] を指定ください。</p><p><img src="/blog/mecm/20220608_02/20220608_02_04.png" alt="image.png"></p><h2 id="再実行の動作の違い"><a href="#再実行の動作の違い" class="headerlink" title="再実行の動作の違い"></a>再実行の動作の違い</h2><p>パッケージとアプリケーションとでは、実行が失敗した際の再実行の動作が異なります。  </p><p><strong>・パッケージ → 特定の設定が必要</strong><br><strong>・アプリケーション → 設定は不要で既定で用意された機能に沿って再実行される。</strong>  </p><p>パッケージでは失敗時にのみ再実行させるためには特定の設定が必要となるのに対して、アプリケーションでは失敗後、既定で設定されているアプリケーションの評価サイクルにより再実行が促されます。  </p><h3 id="パッケージの再実行"><a href="#パッケージの再実行" class="headerlink" title="パッケージの再実行"></a>パッケージの再実行</h3><p>パッケージにおける再実行の動作には抑えておくべきポイントがございます。<br>詳細におきましては「<a href="https://jpmem.github.io/blog/mecm/20220421_01/">MECM パッケージの再実行の設定方法について解説！</a>」をご参照ください。  </p><h3 id="アプリケーションの再実行"><a href="#アプリケーションの再実行" class="headerlink" title="アプリケーションの再実行"></a>アプリケーションの再実行</h3><p>アプリケーションの再実行におきましては、下記の [ソフトウェアの展開] クライアント設定の「展開の再評価スケジュールを指定する」のスケジュールに沿って再実行が必要かどうかを決定します。  </p><p><img src="/blog/mecm/20220608_02/20220608_02_05.png" alt="image.png"></p><p>この再評価スケジュールでは、該当のアプリケーションのインストール状況を確認し、未インストールと判定（後にご紹介する検出規則を元に判定します。）された場合には、このタイミングでインストールを再実行します。  </p><h2 id="アプリケーション特有の機能"><a href="#アプリケーション特有の機能" class="headerlink" title="アプリケーション特有の機能"></a>アプリケーション特有の機能</h2><p>以降はアプリケーション特有の機能についてご紹介させていただきます。  </p><h3 id="アプリケーションのインストール条件を設定する（検出規則）"><a href="#アプリケーションのインストール条件を設定する（検出規則）" class="headerlink" title="アプリケーションのインストール条件を設定する（検出規則）"></a>アプリケーションのインストール条件を設定する（検出規則）</h3><p>アプリケーションには検出規則というインストールを実行するかどうかの判定を行う機能がございます。例えば、特定のレジストリの値を評価し、特定の値よりも小さい場合にはインストールを行う（大きい場合にはインストールをしない）などを設定することができます。なお、検出規則はアプリケーション作成時には必ず設定が必要となります。  </p><p>設定できる検出規則の種類は以下の通りです。  </p><ul><li><strong>ファイル システム</strong><br>ファイル/フォルダの有無、または更新日などを判定条件とすることができます。  </li><li><strong>レジストリ</strong><br>特定のレジストリキーの有無や値の評価を条件とすることができます。  </li><li><strong>Windows インストーラー</strong><br>msi ファイルを読み込ませることで該当のアプリケーションのインストールの有無を条件とすることができます。  </li><li><strong>カスタム スクリプト</strong><br>PowerShell などのスクリプトの実行結果により、判定させることができます。スクリプトの実行結果や、STDOUT の有無などにより、判定結果を決定します。<br>詳細については、<a href="https://docs.microsoft.com/ja-jp/mem/configmgr/apps/deploy-use/create-applications#about-custom-script-detection-methods">カスタム スクリプト検出方法について</a> を参照くださいませ。  </li></ul><p>レジストリを検出規則とした例です。<br>※ アプリケーションの [展開の種類] にて設定を行います。<br><img src="/blog/mecm/20220608_02/20220608_02_06.png" alt="image.png">  </p><h3 id="置き換え関係の構成"><a href="#置き換え関係の構成" class="headerlink" title="置き換え関係の構成"></a>置き換え関係の構成</h3><p>置き換え関係を構成することにより、アプリケーションのインストール時に指定した置き換え関係にあるアプリケーションをアンインストールしてからインストールさせることができます。なお、置き換え規則は必要に応じて設定いただくことが可能でございますので、必須の設定ではございません。  </p><p>例えば、新しいバージョンのアプリケーションをインストールさせたい場合、過去のバージョンのアプリケーションを置き換え関係として設定することで、古いバージョンをアンインストールしてから新しいバージョンのインストールを実行させることができます。  </p><h2 id="まとめ"><a href="#まとめ" class="headerlink" title="まとめ"></a>まとめ</h2><p>パッケージとアプリケーションの違いについて解説させていただきました。おわかりの通り、アプリケーションではパッケージにはない様々な機能を使用することができます。しかし、パッケージの方が手軽に展開を行えることもまた、ご理解いただけたかと思います。  </p><p>そのため、  </p><ul><li><p>シンプルなコマンドの実行やアプリケーションのインストールをしたい</p></li><li><p>1 度だけ実行したい</p></li><li><p>繰り返し実行したい<br>　→　<strong>パッケージ</strong>  </p></li><li><p>インストールの条件を設定したい（条件を満たさない場合には自動的にインストールを促したい）</p></li><li><p>置き換えたいアプリケーションがある<br>　→　<strong>アプリケーション</strong>  </p></li></ul><p>のように使い分けてみましょう！</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チームです。  &lt;/p&gt;
&lt;p&gt;今回は MECM のパッケージとアプリケーションの違いを解説させていただきます。これから展開を行いたいコンテンツがどちらを使えば要望にマッチするのか意識しながら確認し</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
  </entry>
  
  <entry>
    <title>「削除の承認」が Windows 10 2004 以降 / Windows 11 のクライアントに反映されない事象について</title>
    <link href="https://jpmem.github.io/blog/wsus/2022-06-08_01/"/>
    <id>https://jpmem.github.io/blog/wsus/2022-06-08_01/</id>
    <published>2022-06-07T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.134Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。WSUS サポート チームです。</p><p>今回は WSUS で 「削除の承認」 を設定しても  Windows 10 2004 以降 / Windows 11 のクライアントに反映されない事象についてご紹介します。</p><p>本問題は弊社でも同様の動作になることを確認できておりますが、誠に恐縮ながら現時点で修正可否は未定です。<br>本問題について進展がありましたら、本ブログを更新する予定ですので、ご不便をおかけしますが、何卒ご理解賜りますようお願い申し上げます。</p><h1 id="事象の概要"><a href="#事象の概要" class="headerlink" title="事象の概要"></a>事象の概要</h1><p>WSUS サーバー上で更新プログラムの 「削除の承認」 を実施しても、 Windows 10 2004 以降 / Windows 11 のクライアントで更新プログラムのアンインストールが行われません。</p><h1 id="回避策"><a href="#回避策" class="headerlink" title="回避策"></a>回避策</h1><p>現時点で本動作の修正予定はございませんので、恐れ入りますが、更新プログラムのアンインストールについては、手動でアンインストールを実施するか、下記のようなコマンドをスタートアップ スクリプトやシャットダウン スクリプト、資産管理ソフトウェアより配布して、アンインストールを実施してください。</p><p>下記は KB5006670 をアンインストールする場合の手順です。  </p><h2 id="パッケージ-IDの確認"><a href="#パッケージ-IDの確認" class="headerlink" title="パッケージ IDの確認"></a>パッケージ IDの確認</h2><p>対象の更新プログラムがインストールされているクライアントで、以下の手順を実施し、パッケージ ID を確認します。</p><ol><li>コマンド プロンプトを管理者権限で起動します。  </li><li>下記コマンドを実行します。  </li></ol><p><code>dism /get-packages /Online</code></p><ol start="3"><li>パッケージの一覧から KB5006670 に該当するパッケージ ID を探します。<br>※ KB5006670 の OS ビルドは、19041.1288、19042.1288、および 19043.1288 に該当します。</li></ol><p>Title: 2021 年 10 月 12 日 — KB5006670 (OS ビルド 19041.1288、19042.1288、および 19043.1288)<br>URL: <a href="https://support.microsoft.com/ja-jp/topic/2021-%E5%B9%B4-10-%E6%9C%88-12-%E6%97%A5-kb5006670-os-%E3%83%93%E3%83%AB%E3%83%89-19041-1288-19042-1288-%E3%81%8A%E3%82%88%E3%81%B3-19043-1288-8902fc49-af79-4b1a-99c4-f74ca886cd95">https://support.microsoft.com/ja-jp/topic/2021-%E5%B9%B4-10-%E6%9C%88-12-%E6%97%A5-kb5006670-os-%E3%83%93%E3%83%AB%E3%83%89-19041-1288-19042-1288-%E3%81%8A%E3%82%88%E3%81%B3-19043-1288-8902fc49-af79-4b1a-99c4-f74ca886cd95</a></p><p>実行例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">パッケージ ID : Package_for_RollupFix~31bf3856ad364e35~amd64~~19041.1288.1.7　</span><br><span class="line">状態 : インストール済み</span><br><span class="line">リリースの種類 : Security Update</span><br><span class="line">インストール時刻 : 2021/10/13 8:45</span><br></pre></td></tr></table></figure><h2 id="アンインストール-コマンド実行"><a href="#アンインストール-コマンド実行" class="headerlink" title="アンインストール コマンド実行"></a>アンインストール コマンド実行</h2><p>対象の更新プログラムをアンインストールしたいクライアントで、以下の手順コマンドで対象のパッケージ ID を指定し、更新プログラムをアンインストールします。<br><code>dism /Online /remove-package /PackageName:&lt;パッケージ ID&gt;</code></p><p>（例）<br><code>dism /Online /remove-package /PackageName:Package_for_RollupFix~31bf3856ad364e35~amd64~~19041.1288.1.7　/quiet /Norestart</code></p><p>※ /quiet は、サイレントでアンインストールするオプションです。/norestart は、更新プログラムのアンインストール後、再起動されないようにするためのオプションです。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。WSUS サポート チームです。&lt;/p&gt;
&lt;p&gt;今回は WSUS で 「削除の承認」 を設定しても  Windows 10 2004 以降 / Windows 11 のクライアントに反映されない事象についてご紹介します。&lt;/p&gt;
&lt;p&gt;本問題は弊社でも</summary>
      
    
    
    
    
    <category term="WSUS" scheme="https://jpmem.github.io/blog/tags/WSUS/"/>
    
  </entry>
  
  <entry>
    <title>Azure ネットワーク接続 (ANC) のチェック時にエラーが出る際のチェックポイント（Azure AD デバイス同期編）</title>
    <link href="https://jpmem.github.io/blog/w365/2022-06-06_01/"/>
    <id>https://jpmem.github.io/blog/w365/2022-06-06_01/</id>
    <published>2022-06-05T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.062Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Microsoft Endpoint Manager サポート 山田です。<br>本日は、Windows 365 Enterprise 環境で、Azure ネットワーク接続 (ANC) のチェック時に Azure AD デバイス同期の項目でエラーが発生する際に確認するポイントについてご紹介します。  </p><h2 id="免責事項"><a href="#免責事項" class="headerlink" title="免責事項"></a>免責事項</h2><p>下記内容は 2022/6/6 時点での内容についての記載となっております。<br>今後内容が更新されることもございますので、その点ご承知置きくださいますようお願い致します。  </p><h3 id="Azure-AD-デバイス同期とは"><a href="#Azure-AD-デバイス同期とは" class="headerlink" title="Azure AD デバイス同期とは"></a>Azure AD デバイス同期とは</h3><p>ANC チェック時の一番上の項目です。  </p><p><img src="/blog/w365/2022-06-06_01/2022-06-06-17-50-13.png">  </p><p>上記項目でエラーが発生する際に見るべき点について以下にご紹介いたします。  </p><h4 id="1-ANC-の-AD-ドメイン-が正しく構成されているか"><a href="#1-ANC-の-AD-ドメイン-が正しく構成されているか" class="headerlink" title="1. ANC の [AD ドメイン] が正しく構成されているか"></a>1. ANC の [AD ドメイン] が正しく構成されているか</h4><p>a. グローバル管理者などの権限を持つアカウントで Microsoft Endpoint Manager admin center (<a href="https://aka.ms/memac">https://aka.ms/memac</a>) にログインします。<br>b. [デバイス] - [Windows 365] - [Azure ネットワーク接続] と辿り、使用している ANC を選択します。<br>c. [プロパティ] を開き、[AD ドメイン] の右にある [編集] を選択します。<br>d. 以下の各項目を入力していきます。  </p><p>AD DNS ドメイン名：contoso.com のような形式でドメイン名を入力します。<br>組織単位：クラウド PC のコンピューターオブジェクトが生成される OU を指定します。  </p><p>■例<br>OU=CloudPC,DC=contoso,DC=com  </p><p>AD ユーザー名 UPN：ドメイン参加を実行し、コンピューターオブジェクトの書き込み権限がある UPN を指定します。  </p><p>■例<br><a href="mailto:&#119;&#x69;&#x6e;&#100;&#x6f;&#119;&#115;&#x33;&#54;&#53;&#x40;&#99;&#111;&#x6e;&#x74;&#x6f;&#115;&#x6f;&#46;&#x63;&#111;&#109;">&#119;&#x69;&#x6e;&#100;&#x6f;&#119;&#115;&#x33;&#54;&#53;&#x40;&#99;&#111;&#x6e;&#x74;&#x6f;&#115;&#x6f;&#46;&#x63;&#111;&#109;</a>  </p><p>AD ドメインのパスワード：上記 UPN のパスワードを入力します。<br>AD ドメインのパスワードの確認：同じパスワードを入力します。  </p><p>e. [次へ] を選択し、ANC のチェックがすべて成功することを確認します。  </p><h4 id="2-仮想ネットワークの-DNS-サーバー指定について"><a href="#2-仮想ネットワークの-DNS-サーバー指定について" class="headerlink" title="2. 仮想ネットワークの DNS サーバー指定について"></a>2. 仮想ネットワークの DNS サーバー指定について</h4><p>以下の手順で、ご使用いただいている仮想ネットワークの DNS サーバーが、オンプレミスの DNS サーバーを指定しているか確認します。  </p><p>a. Azure Portal（<a href="https://portal.azure.com)から、windows/">https://portal.azure.com）から、Windows</a> 365 Enterprise で使用する仮想ネットワークを開きます。<br>b. [概要] 内にある [DNS サーバー] がオンプレミスの DNS サーバーの IP アドレスが入力されているか確認します。  </p><h4 id="3-ネットワーク要件について"><a href="#3-ネットワーク要件について" class="headerlink" title="3. ネットワーク要件について"></a>3. ネットワーク要件について</h4><p>ご使用いただいている仮想ネットワークが VPN や Proxy などを使用している場合、ネットワーク構成を見直す必要がございます。<br>具体的には、仮想ネットワークから以下の公開情報に記載されているエンドポイント URL に直接アクセスできるように構成していただき、再度 ANC チェックに成功するかご確認ください。  </p><p><a href="https://docs.microsoft.com/ja-jp/windows-365/enterprise/requirements-network#allow-network-connectivity">ネットワーク要件</a>  </p><p>以上、Azure AD デバイス同期時のエラー解消の参考になれば幸いです。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Microsoft Endpoint Manager サポート 山田です。&lt;br&gt;本日は、Windows 365 Enterprise 環境で、Azure ネットワーク接続 (ANC) のチェック時に Azure AD デバイス同期の項目でエラーが発生</summary>
      
    
    
    
    
    <category term="Windows 365" scheme="https://jpmem.github.io/blog/tags/Windows-365/"/>
    
  </entry>
  
  <entry>
    <title>WSUS の仕組み ダウンロード編</title>
    <link href="https://jpmem.github.io/blog/wsus/2022-06-06_01/"/>
    <id>https://jpmem.github.io/blog/wsus/2022-06-06_01/</id>
    <published>2022-06-05T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.122Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。WSUS サポート チームです。</p><p>今回は、WSUS の仕組みについて、少し掘り下げてご紹介していきたいと思います。<br>WSUS は更新プログラムをクライアントへ配信できる機能であることはご存じの方も多いかと思いますが、どのような過程を経て更新プログラムがクライアントに取得されるかご存じでしょうか。<br>仕組みの理解やトラブルシューティング時にもお役立ていただけるとなっておりますのでぜひご一読ください！</p><h1 id="WSUS-の仕組み"><a href="#WSUS-の仕組み" class="headerlink" title="WSUS の仕組み"></a>WSUS の仕組み</h1><p>WSUS からクライアントが更新プログラムを取得するまでの流れ配下の通りです。（既定動作）</p><ol><li>WSUS 同期</li><li>更新プログラムの承認</li><li>クライアントが承認情報を取得</li></ol><p>解説</p><ol><li><p>WSUS 同期<br> WSUS は、更新プログラムを同期させる際に、カタログ情報と呼ばれるメタデータをダウンロードします。<br> この時、更新プログラムのコンテンツ ファイルと呼ばれる実体ファイルはダウンロードしません。<br> このカタログ情報は実体となるコンテンツファイルよりもファイルサイズは小さいものとなり、カタログ情報は WSUS データベース (SUSDB) に格納されます。<br><img src="/blog/wsus/2022-06-06_01/2022-06-06_01_6.png"></p><p>また、このカタログ情報は、アップストリーム サーバーがインターネットになっている場合には、Microsoft Update からダウンロードされます。<br> 一方、アップストリーム WSUS が指定されている場合は、アップストリーム WSUS からダウンロードされます。<br> アップストリームサーバーは、 WSUS コンソールにて以下より設定いただけます。<br>[オプション] &gt; [更新元及びプロキシサーバー]<br> <img src="/blog/wsus/2022-06-06_01/2022-06-06_01_12.png"></p></li><li><p>更新プログラムの承認<br>2-1.承認作業を実施することにより、 WSUS データベースの承認情報が変更されます。<br> <img src="/blog/wsus/2022-06-06_01/2022-06-06_01_13.png"><br> <img src="/blog/wsus/2022-06-06_01/2022-06-06_01_14.png"><br>2-2. WSUS にて承認作業が行われることによって、更新プログラムのコンテンツ ファイルのダウンロードが開始されます。<br>このとき、更新プログラムの実体となるコンテンツ ファイルが WsusContent フォルダーにダウンロードされます。<br><img src="/blog/wsus/2022-06-06_01/2022-06-06_01_7.png"></p></li><li><p>クライアントが承認情報を取得<br>クライアントは、（ランダム時間を含む）既定で約 22 時間毎に WindowsUpdate の自動更新を実行し、 WSUS へスキャン処理を実施します。自らに必要な更新プログラムが承認されていた場合には、その情報をもとに、自動更新の構成ポリシーの設定に従って適用作業を実施します。<br><img src="/blog/wsus/2022-06-06_01/2022-06-06_01_8.png"></p></li></ol><h1 id="補足情報"><a href="#補足情報" class="headerlink" title="補足情報"></a>補足情報</h1><h2 id="WSUS-サーバー上のコンテンツ-ファイルの有無を確認"><a href="#WSUS-サーバー上のコンテンツ-ファイルの有無を確認" class="headerlink" title="WSUS サーバー上のコンテンツ ファイルの有無を確認"></a>WSUS サーバー上のコンテンツ ファイルの有無を確認</h2><p>1． WSUS コンソールで対象の更新プログラムを右クリックし「 ファイル情報 」を参照します。<br><img src="/blog/wsus/2022-06-06_01/2022-06-06_01_1.png"><br>2．更新プログラムの URI が表示されています。これが更新プログラムの実体ファイルの格納先になります。<br><img src="/blog/wsus/2022-06-06_01/2022-06-06_01_2.png"><br>3． WSUS サーバーのエクスプローラーから「 WsusContent 」フォルダーを開きます。<br> 　 2 ケタの英数字で名づけられたフォルダーが複数存在しますので、手順 2 で確認したファイルパス内に記載されているフォルダーをたどっていきます。<br> <img src="/blog/wsus/2022-06-06_01/2022-06-06_01_3.png"><br>4．フォルダー内に格納されているファイルが存在するかを確認します。<br> <img src="/blog/wsus/2022-06-06_01/2022-06-06_01_4.png"></p><p>5． WSUS コンソール上では [更新プログラム] の表示にて、ファイルの状態列を追加し、コンテンツ ファイルのダウンロード状況を確認いただけます。<br>カラムを右クリックし、” ファイルの状態 “　を列に追加します。<br><img src="/blog/wsus/2022-06-06_01/2022-06-06_01_9.png"><br>“ ファイルの状態 “ 列のアイコンで「ダウンロード中」や、「インストール準備完了」(コンテンツ ファイルのダウンロードが完了したことを示す) になっているかを確認できます。<br><img src="/blog/wsus/2022-06-06_01/2022-06-06_01_10.png"><br><img src="/blog/wsus/2022-06-06_01/2022-06-06_01_11.png"></p><h2 id="コンテンツ-ファイルの削除方法"><a href="#コンテンツ-ファイルの削除方法" class="headerlink" title="コンテンツ ファイルの削除方法"></a>コンテンツ ファイルの削除方法</h2><p>1.承認済みの更新プログラムの拒否済みへ変更します。<br>2.クリーンナップウィザードの “不要な更新ファイル” を実施しますと拒否済みとした更新プログラムのコンテンツ ファイルがサーバーから削除されます。<br><img src="/blog/wsus/2022-06-06_01/2022-06-06_01_5.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。WSUS サポート チームです。&lt;/p&gt;
&lt;p&gt;今回は、WSUS の仕組みについて、少し掘り下げてご紹介していきたいと思います。&lt;br&gt;WSUS は更新プログラムをクライアントへ配信できる機能であることはご存じの方も多いかと思いますが、どのような過程を</summary>
      
    
    
    
    
    <category term="WSUS" scheme="https://jpmem.github.io/blog/tags/WSUS/"/>
    
  </entry>
  
  <entry>
    <title>MEM における共同管理のよくある質問 (FAQ) とトラブルシューティング</title>
    <link href="https://jpmem.github.io/blog/mecm/20220529_01/"/>
    <id>https://jpmem.github.io/blog/mecm/20220529_01/</id>
    <published>2022-05-28T15:00:00.000Z</published>
    <updated>2022-09-30T05:56:50.026Z</updated>
    
    <content type="html"><![CDATA[<p>みなさま、こんにちは。Configuration Manager サポート チームです。  </p><p>本日は、Microsoft Endpoint Manager　(MEM) が提供する共同管理 のよくある質問 (FAQ)、およびよくあるトラブルシューティング方法についてご案内いたします。なお、本記事は随時アップデートされる予定です。</p><h2 id="よくある質問-FAQ"><a href="#よくある質問-FAQ" class="headerlink" title="よくある質問 (FAQ)"></a>よくある質問 (FAQ)</h2><h3 id="共同管理の利用条件"><a href="#共同管理の利用条件" class="headerlink" title="共同管理の利用条件"></a>共同管理の利用条件</h3><h4 id="Intune-と-MECM-の組み合わせ以外で共同管理は構成できるか"><a href="#Intune-と-MECM-の組み合わせ以外で共同管理は構成できるか" class="headerlink" title="Intune と MECM の組み合わせ以外で共同管理は構成できるか"></a>Intune と MECM の組み合わせ以外で共同管理は構成できるか</h4><p>大変申し訳ございませんが、他ベンダー様の製品と弊社製品での組み合わせにおける共同管理は構成できません。なお、他社 MDM 製品と MECM クライアントが同居している状態は以下でご案内している「共存」状態となりますのでご留意ください。</p><p>Configuration Manager (CM) における共存状態について<br><a href="https://jpmem.github.io/blog/mecm/20211214_01/">https://jpmem.github.io/blog/mecm/20211214_01/</a></p><h4 id="Azure-AD-Registered-状態のデバイスは共同管理できないのか"><a href="#Azure-AD-Registered-状態のデバイスは共同管理できないのか" class="headerlink" title="Azure AD Registered 状態のデバイスは共同管理できないのか"></a>Azure AD Registered 状態のデバイスは共同管理できないのか</h4><p>共同管理状態にできません。Azure AD Joined 状態もしくは Hybrid Azure AD Joined 状態にできるようにしてください。</p><h4 id="共同管理における-MECM-サーバーと-Intune-の接続条件は"><a href="#共同管理における-MECM-サーバーと-Intune-の接続条件は" class="headerlink" title="共同管理における MECM サーバーと Intune の接続条件は"></a>共同管理における MECM サーバーと Intune の接続条件は</h4><p>共同管理において、MECM サーバーは Intune と接続できる必要はございません。管理対象のクライアントがそれぞれ MECM サーバー、 Intune に接続できるようにしてください。その他のインターネット アクセス要件は以下をご確認ください。</p><p>インターネット アクセス要件<br><a href="https://docs.microsoft.com/ja-jp/mem/configmgr/core/plan-design/network/internet-endpoints">https://docs.microsoft.com/ja-jp/mem/configmgr/core/plan-design/network/internet-endpoints</a></p><h4 id="共同管理において、クラウド管理ゲートウェイ-CMG-の利用は必須か"><a href="#共同管理において、クラウド管理ゲートウェイ-CMG-の利用は必須か" class="headerlink" title="共同管理において、クラウド管理ゲートウェイ (CMG) の利用は必須か"></a>共同管理において、クラウド管理ゲートウェイ (CMG) の利用は必須か</h4><p>お客様のご利用要件によっては必須ではございません。以下のようなケースでは CMG が必要となってまいりますのでご検討ください。</p><ol><li>イントラネットでのキッティングを行わないため、インターネット経由で MECM サーバーに登録する必要がある。(AutoPilot の利用ケースなど)</li><li>長期出張などで長期間イントラネット内の MECM サーバーに接続出来ない期間がある</li></ol><h3 id="Intune-画面"><a href="#Intune-画面" class="headerlink" title="Intune 画面"></a>Intune 画面</h3><h4 id="特に共同管理設定を実施していないのに-Intune-上のデバイス一覧にて「管理者」項目が「共同管理」になった。"><a href="#特に共同管理設定を実施していないのに-Intune-上のデバイス一覧にて「管理者」項目が「共同管理」になった。" class="headerlink" title="特に共同管理設定を実施していないのに Intune 上のデバイス一覧にて「管理者」項目が「共同管理」になった。"></a>特に共同管理設定を実施していないのに Intune 上のデバイス一覧にて「管理者」項目が「共同管理」になった。</h4><p>以下の画面の状況かと存じます。  </p><p><img src="/blog/mecm/20220529_01/20220529_01_01.png" alt="image.png">  </p><p>2022 年 5 月現在、Intune クライアントは自身の端末に MECM クライアントが存在するのを検出すると、実際には共同管理状態になっていなくても、該当の項目を「共同管理」に切り替えてしまいます。 正しく共同管理状態にするには MECM コンソール上にて共同管理構成設定をする必要がございますので、ご理解くださいますようお願いいたします。共同管理の設定方法については以下ブログ記事をご参照ください。</p><p>Configuration Manager における共同管理機能について<br><a href="https://jpmem.github.io/blog/mecm/20220321_01/">https://jpmem.github.io/blog/mecm/20220321_01/</a></p><h4 id="共同管理設定後、Intune-上のデバイスの「管理者」項目が「ConfigMgr」となった。"><a href="#共同管理設定後、Intune-上のデバイスの「管理者」項目が「ConfigMgr」となった。" class="headerlink" title="共同管理設定後、Intune 上のデバイスの「管理者」項目が「ConfigMgr」となった。"></a>共同管理設定後、Intune 上のデバイスの「管理者」項目が「ConfigMgr」となった。</h4><p>以下の画面の状況かと存じます。  </p><p><img src="/blog/mecm/20220529_01/20220529_01_02.png" alt="image.png">  </p><p>上記は、共同管理状態ではなく、MECM コンソールの以下の設定により、MECM クライアントのみがインストールされているデバイスの識別情報がアップロードされている状態です。</p><ul><li>[MECM コンソール] - [管理] - [概要] - [クラウド サービス] - [クラウドの接続] - [プロパティ] - [アップロードを構成する]<ul><li>[Microsoft エンドポイント マネージャー管理センターにアップロードする] が有効化されている</li></ul></li></ul><p><img src="/blog/mecm/20220529_01/20220529_01_03.png" alt="image.png">  </p><p>本アップロードは「テナント アタッチ」機能のために行われ、テナント アタッチ機能は MECM コンソールで実施していた幾つかの作業を、代わりに Intune (MEM 管理センター)の画面を通して行うための機能です。共同管理とは直接は関係のない機能となりますのでご承知おきください。テナント アタッチについては以下を参照ください。</p><p>テナントのアタッチ ドキュメント<br><a href="https://docs.microsoft.com/ja-jp/mem/configmgr/tenant-attach/">https://docs.microsoft.com/ja-jp/mem/configmgr/tenant-attach/</a></p><h3 id="共同管理にしたくない"><a href="#共同管理にしたくない" class="headerlink" title="共同管理にしたくない"></a>共同管理にしたくない</h3><h4 id="都合上、共同管理構成に出来ないのだが、デバイスにIntune-クライアントと-MECM-クライアントがインストールされている。この状態で継続利用可能か"><a href="#都合上、共同管理構成に出来ないのだが、デバイスにIntune-クライアントと-MECM-クライアントがインストールされている。この状態で継続利用可能か" class="headerlink" title="都合上、共同管理構成に出来ないのだが、デバイスにIntune クライアントと MECM クライアントがインストールされている。この状態で継続利用可能か"></a>都合上、共同管理構成に出来ないのだが、デバイスにIntune クライアントと MECM クライアントがインストールされている。この状態で継続利用可能か</h4><p>恐れ入りますが、 共同管理構成されていない、Intune クライアントと MECM クライアントの同居状態は 2022 年5 月時点では非サポートとなります。必ず共同管理構成にするか、出来ない場合はどちらかのクライアントをアンインストールくださいますようお願いいたします。</p><h4 id="MECM-で管理しているデバイス全てを共同管理構成にはしたくない"><a href="#MECM-で管理しているデバイス全てを共同管理構成にはしたくない" class="headerlink" title="MECM で管理しているデバイス全てを共同管理構成にはしたくない"></a>MECM で管理しているデバイス全てを共同管理構成にはしたくない</h4><p>パイロット コレクションをご利用ください。パイロット コレクションを利用することにより、MECM で管理している一部の端末のみ、ワークロードを Intune に寄せることが可能です。なお、ワークロードごとに設定するコレクションを変更することも可能です。なお、恐れながらパイロット コレクションに指定できるコレクションは各ワークロードごとに 1 つだけとなることにご留意ください。</p><h2 id="トラブルシューティング"><a href="#トラブルシューティング" class="headerlink" title="トラブルシューティング"></a>トラブルシューティング</h2><h3 id="共同管理状態にならない"><a href="#共同管理状態にならない" class="headerlink" title="共同管理状態にならない"></a>共同管理状態にならない</h3><p>共同管理状態にならない理由は大凡以下となります。</p><ol><li>クライアントが共同管理構成ポリシーを入手できない</li><li>クライアントが Hybrid Azure AD Join / Azure AD Join できない</li><li>クライアントが Intune に登録できない</li><li>クライアントに他社 MDM 製品がインストールされている </li></ol><h4 id="クライアントが-共同管理構成ポリシーを入手できない"><a href="#クライアントが-共同管理構成ポリシーを入手できない" class="headerlink" title="クライアントが 共同管理構成ポリシーを入手できない"></a>クライアントが 共同管理構成ポリシーを入手できない</h4><p>MECM のコントロールパネルアプレットを開いたとき、「構成」タブで「CoMgmtSettings～」の項目が無い場合、クライアントが MECM サーバー (管理ポイント) と接続できていない場合が多くございます。この場合、管理ポイントとの接続状況をご確認ください。ClientLocation.log, CcmMessaging.log , DataTransferService.log 等が参考になるかと存じます。</p><p><img src="/blog/mecm/20220529_01/20220529_01_04.png" alt="image.png">  </p><p>また、パイロット　コレクションに設定したのに、上記画面で「CoMgmtSettingsPilot～」の項目が無い場合、クライアントが該当のコレクションに所属していないことが考えられます。コレクションの参加条件をご確認ください。</p><h4 id="クライアントが-Hybrid-Azure-AD-Join-Azure-AD-Join-できない"><a href="#クライアントが-Hybrid-Azure-AD-Join-Azure-AD-Join-できない" class="headerlink" title="クライアントが Hybrid Azure AD Join / Azure AD Join できない"></a>クライアントが Hybrid Azure AD Join / Azure AD Join できない</h4><p>Hybrid Azure AD Join の状態は下記でご案内しております dsregcmd /status コマンドで確認できます。</p><p>Azure AD Join 状態の調査<br><a href="https://jpmem.github.io/memlog/general/azuread/dsregcmd-status.html">https://jpmem.github.io/memlog/general/azuread/dsregcmd-status.html</a></p><p>よくある事例は、以下の通りでございます。</p><ul><li>Proxy を介さないと Azure AD に到達できないため、AzureAdPRT の項が YES となっていない。この場合は、WinHTTP プロキシを設定する必要がございます。設定しても Proxy が Azure AD に到達できない場合は、到達できるように設定する必要がございます。ネットワークが頻繁に変わる場合は WPAD の採用をご検討ください。</li><li>Azure AD connect の同期が終わってない。この場合は同期が終わるまで待つ必要がございます。</li><li>Azure AD Registered の状態になっている。この場合は 一度 Registered 状態を解除する必要がございます。</li></ul><h4 id="クライアントが-Intune-に登録できない"><a href="#クライアントが-Intune-に登録できない" class="headerlink" title="クライアントが Intune に登録できない"></a>クライアントが Intune に登録できない</h4><p>Intune への接続が出来ない等の理由で登録が失敗している場合がございます。以下でご案内している Intune のインターネットアクセス要件をご確認ください。<br>また、この他 Intune 側の登録ポリシー等で制限されている場合もございますので、ご確認ください。</p><p>Microsoft Intune のネットワーク エンドポイント<br><a href="https://docs.microsoft.com/ja-jp/mem/intune/fundamentals/intune-endpoints">https://docs.microsoft.com/ja-jp/mem/intune/fundamentals/intune-endpoints</a></p><h4 id="クライアントに他社-MDM-製品がインストールされている"><a href="#クライアントに他社-MDM-製品がインストールされている" class="headerlink" title="クライアントに他社 MDM 製品がインストールされている"></a>クライアントに他社 MDM 製品がインストールされている</h4><p>クライアントに他社 MDM 製品がインストールされている場合、共同構成ではなく、共存状態となります。この場合、他社 MDM 製品をアンインストールする必要がございますので、ご理解賜りますようお願いいたします。MECM の CoManagementHandler.log に以下の出力があると、共存状態と判定されていると確認できます。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">This device is enrolled to an unexpected vendor, it will be set in co-existence mode</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;みなさま、こんにちは。Configuration Manager サポート チームです。  &lt;/p&gt;
&lt;p&gt;本日は、Microsoft Endpoint Manager　(MEM) が提供する共同管理 のよくある質問 (FAQ)、およびよくあるトラブルシューティング方法につ</summary>
      
    
    
    
    
    <category term="MECM" scheme="https://jpmem.github.io/blog/tags/MECM/"/>
    
    <category term="共同管理" scheme="https://jpmem.github.io/blog/tags/%E5%85%B1%E5%90%8C%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
</feed>
